import{r as s,j as t,a as r,N as C,b as I,C as b,R as L,F as _,c as D}from"./index.19b01455.js";import{T as O}from"./TextArea.414900e7.js";import{I as T}from"./InputText.7137eebb.js";import{P as w}from"./PanelWithBackdrop.63dd6ed5.js";var y=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(y||{});const F=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function V(e){const[n,o]=s.exports.useState(()=>e.initialNavState),l=s.exports.useId();function c(a){const{currentTarget:N}=a,x=+N.name;n!==x&&(e.setNavNotesState(x),o(x))}const i=F.map((a,N)=>t("button",{className:n===a.btnValue?"note-nav__selected":"",name:a.btnValue.toString(),onClick:c,children:a.navTitle},`${l}-${N}`));return t("section",{className:"note-nav",children:i})}let H=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function M(e,n){var m;const[o,l]=s.exports.useState((m=e.defaultOption)!=null?m:e.options[0]),[c,i]=s.exports.useState(!1),a=s.exports.useId();s.exports.useImperativeHandle(n,()=>({resetSelectValue(){var d;l((d=e.defaultOption)!=null?d:e.options[0])}}));function N(){i(d=>!d)}function x(d){const h=d.target.value;h!==o&&(l(h),e.onSelection(h)),i(!1)}return r("div",{className:"select-interactive",children:[t("div",{className:`select-interactive__ctn ${c?"select-interactive__ctn--open":""}`,onClick:N,title:o.toString(),role:"button",tabIndex:0,onBlur:()=>i(!1),children:o}),t("div",{className:`select-interactive__options ${c?"select-interactive__options--open":""}`,children:e.options.map((d,h)=>t("button",{type:"button",value:d,onClick:x,title:d,className:d===o?"selected":"",children:d},`${a}-${h}`))})]})}const R=s.exports.forwardRef(M);function P(){const e=s.exports.useContext(C),n=s.exports.useContext(I),o=s.exports.useContext(b).getCategories(),l=s.exports.useRef(null),[c,i]=s.exports.useState("none"),a=s.exports.useRef(null),[N,x]=s.exports.useState(""),m=s.exports.useRef(null),[d,h]=s.exports.useState("");function u(){var f;x(""),a.current.value="",h(""),m.current.value="",i("none"),(f=l.current)==null||f.resetSelectValue()}function g(f){f.preventDefault();const S={title:N,category:c,text:d,id:H()};n.showNotification("Note added !"),e.addNote(S),u()}return r("div",{className:"create-note-container",children:[t("h1",{children:"Create a note"}),r("form",{onSubmit:g,children:[t(T,{ref:a,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30,onChangeHandler:x}),r("div",{className:"field",children:["Choose a category"," ",t(R,{options:o,onSelection:f=>{i(f)},ref:l})]}),t(O,{name:"textNote",ref:m,onChangeHandler:h}),r("div",{className:"field-group-btns",children:[t("button",{type:"submit",className:"btn-blue",disabled:N.length<3,children:"Save"}),t("button",{type:"button",className:"btn-blue red",onClick:u,disabled:N.length===0&&c==="none"&&d==="",children:"Discard"})]})]})]})}function $(e){const{title:n,category:o,text:l}=e.note,c=l.split(`
`).map((i,a)=>r(L.Fragment,{children:[i,t("br",{})]},a));return r(w,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:c})]})}function B(e){const[n,o]=s.exports.useState(!1);function l(){o(!0)}function c(){o(!1)}return r(_,{children:[n&&t($,{note:e,closeNote:c}),r("div",{className:"note-item",onClick:l,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category.length>0&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function Y(e,n){const o=e.category==="none"?"":e.category,l=n.category==="none"?"":n.category;return o>l?1:o<l?-1:e.title>n.title?1:e.title<n.title?-1:0}function E(e){return e.sort(Y)}function j(){const e=E(s.exports.useContext(C).getNotes()),n=s.exports.useContext(b).getCategories(),[o,l]=s.exports.useState("all"),c=e.filter(a=>o==="all"||a.category===o).map(a=>t(B,{id:a.id,title:a.title,text:a.text,category:a.category},a.id)),i=c.length;return r("div",{className:"view-notes",children:[e.length>0&&r("h3",{children:[t("span",{children:"Select a category\xA0"}),t(R,{options:["all",...n],onSelection:a=>{l(a)}})]}),t("h1",{children:i===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":i===1?"You have only 1 note!":`You have ${i} notes!`}),i>0&&t("div",{className:"view-notes__container",children:c})]})}function A(e){var n,o;return r("div",{className:"note-item-edit",children:[e.numOfFirstLetersToHighlight?r("h2",{title:e.title,children:[t("span",{className:"text-highlighted",children:(n=e.title)==null?void 0:n.slice(0,e.numOfFirstLetersToHighlight)}),(o=e.title)==null?void 0:o.slice(e.numOfFirstLetersToHighlight)]}):t("h2",{title:e.title,children:e.title}),e.category!==D[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function W({note:e,closeEditMode:n}){const o=s.exports.useContext(I),l=s.exports.useContext(C),c=s.exports.useContext(b).getCategories(),i=s.exports.useRef(null),[a,N]=s.exports.useState(e.category),x=s.exports.useRef(null),[m,d]=s.exports.useState(e.title),h=s.exports.useRef(null),[u,g]=s.exports.useState(e.text),f=m!==e.title||a!==e.category||u!==e.text;function S(v){v.preventDefault();const p={title:x.current.value,category:a,text:h.current.value,id:e.id};(p.title!==e.title||p.category!==e.category||p.text!==e.text)&&(l.modifyNote(p),o.showNotification("Note changed !"))}function k(){var v;x.current.value=e.title,d(e.title),h.current.value=e.text,g(e.text),(v=i.current)==null||v.resetSelectValue(),N(e.category)}return r(w,{closePanel:n,plusClass:"panel-max-extended",children:[t("h2",{children:"Edit note "}),r("form",{onSubmit:S,children:[t(T,{ref:x,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title,onChangeHandler:d}),r("div",{className:"field",children:["Change the category",t(R,{options:c,defaultOption:e.category,onSelection:v=>{N(v)},ref:i})]}),t(O,{name:"textNote",ref:h,value:e.text,onChangeHandler:g}),r("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",disabled:!f,children:"Save"}),t("button",{type:"button",onClick:k,className:"btn-blue red",title:"Reset to the last saved content",disabled:!f,children:"Discard changes"})]})]})]})}function U(e){const n=s.exports.useContext(C),o=s.exports.useRef(null);function l(){var i;(i=o.current)==null||i.closeBackdrop()}function c(){n.deleteNoteById(e.id),l()}return r(w,{closePanel:e.closeDeleteForm,plusClass:"panel-mind-extended",ref:o,children:[t("h1",{children:"Do you really want to delete this note?"}),r("div",{children:[t("button",{className:"confirmation-btn",onClick:c,children:"Yes"}),t("button",{className:"confirmation-btn btn-no",onClick:l,children:"No"})]})]})}const q=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(W,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(U,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function K(){const[e,n]=s.exports.useReducer(q,void 0),o=E(s.exports.useContext(C).getNotes()),l=o.length,[c,i]=s.exports.useState(""),a=c.length;function N(u){n({type:1,item:u,closeEditMode:m})}function x(u){n({type:2,item:u,closeEditMode:m})}function m(){n({type:0})}const d=c.toLowerCase(),h=o.filter(u=>u.title.toLowerCase().startsWith(d)).map((u,g)=>t(A,{title:u.title,numOfFirstLetersToHighlight:a,category:u.category,text:u.text,modifyItem:()=>{N(u)},deleteItem:()=>{x(u)}},g));return r("div",{className:"edit-note-container",children:[e,l===0&&t("h2",{children:"You don't have any notes to edit!"}),l>3&&t(T,{required:!1,text:"Search the note by name",onChangeHandler:u=>{i(u)}}),h.length>0&&t("div",{className:"notes-container",children:h}),h.length===0&&a>0&&t("h2",{children:"You don't have any note with this name!"})]})}const z=[{noteState:y.viewNotes,component:t(j,{})},{noteState:y.createNote,component:t(P,{})},{noteState:y.editNote,component:t(K,{})}];function G({currentStatus:e}){const n=z.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function ee(){const[e,n]=s.exports.useState({navNotesState:y.viewNotes});function o(l){n({navNotesState:l})}return r("section",{className:"note-container",children:[t(V,{initialNavState:e.navNotesState,setNavNotesState:o}),t(G,{currentStatus:e.navNotesState})]})}export{ee as default};
