import{r as s,j as t,a as d,N as v,b as R,C as b,R as D,F as O,c as V}from"./index.3db5dfad.js";import{T as I}from"./TextArea.739ece15.js";import{I as E}from"./InputText.6e812055.js";import{P as T}from"./PanelWithBackdrop.0e653a19.js";var g=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(g||{});const M=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function F(e){const[n,o]=s.exports.useState(()=>e.initialNavState),l=s.exports.useId();function r(a){const{currentTarget:i}=a,h=+i.name;n!==h&&(e.setNavNotesState(h),o(h))}const c=M.map((a,i)=>t("button",{className:n===a.btnValue?"note-nav__selected":"",name:a.btnValue.toString(),onClick:r,children:a.navTitle},`${l}-${i}`));return t("section",{className:"note-nav",children:c})}let P=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function Y(e,n){var m;const[o,l]=s.exports.useState((m=e.defaultOption)!=null?m:e.options[0]),[r,c]=s.exports.useState(!1),a=s.exports.useId();s.exports.useImperativeHandle(n,()=>({resetSelectValue(){var u;l((u=e.defaultOption)!=null?u:e.options[0])}}));function i(){c(u=>!u)}function h(u){const x=u.target.value;x!==o&&(l(x),e.onSelection(x)),c(!1)}return d("div",{className:"select-interactive",children:[t("div",{className:`select-interactive__ctn ${r?"select-interactive__ctn--open":""}`,onClick:i,title:o.toString(),role:"button",tabIndex:0,onBlur:()=>c(!1),children:o}),t("div",{className:`select-interactive__options ${r?"select-interactive__options--open":""}`,children:e.options.map((u,x)=>t("button",{type:"button",value:u,onClick:h,title:u,className:u===o?"selected":"",children:u},`${a}-${x}`))})]})}const w=s.exports.forwardRef(Y);function $(){const e=s.exports.useContext(v),n=s.exports.useContext(R),o=s.exports.useContext(b).getCategories(),l=s.exports.useRef(null),[r,c]=s.exports.useState("none"),a=s.exports.useRef(null),[i,h]=s.exports.useState(""),m=s.exports.useRef(null),[u,x]=s.exports.useState("");function p(){var N;h(""),a.current.value="",x(""),m.current.value="",c("none"),(N=l.current)==null||N.resetSelectValue()}function y(N){N.preventDefault();const S={title:i,category:r,text:u,id:P()};n.showNotification("Note added !"),e.addNote(S),p()}return d("div",{className:"create-note-container",children:[t("h1",{children:"Create a note"}),d("form",{onSubmit:y,children:[t(E,{ref:a,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30,onChangeHandler:h}),d("div",{className:"field",children:["Choose a category"," ",t(w,{options:o,onSelection:N=>{c(N)},ref:l})]}),t(I,{name:"textNote",ref:m,onChangeHandler:x}),d("div",{className:"field-group-btns",children:[t("button",{type:"submit",className:"btn-blue",disabled:i.length<3,children:"Save"}),t("button",{type:"button",className:"btn-blue red",onClick:p,disabled:i.length===0&&r==="none"&&u==="",children:"Discard"})]})]})]})}function B(e){const{title:n,category:o,text:l}=e.note,r=l.split(`
`).map((c,a)=>d(D.Fragment,{children:[c,t("br",{})]},a));return d(T,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:r})]})}function H(e){const[n,o]=s.exports.useState(!1);function l(){o(!0)}function r(){o(!1)}return d(O,{children:[n&&t(B,{note:e,closeNote:r}),d("div",{className:"note-item",onClick:l,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category.length>0&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function L(e,n){const o=e.category==="none"?"":e.category,l=n.category==="none"?"":n.category;return o>l?1:o<l?-1:e.title>n.title?1:e.title<n.title?-1:0}function k(e){return e.sort(L)}function j(){const e=k(s.exports.useContext(v).getNotes()),n=s.exports.useContext(b).getCategories(),[o,l]=s.exports.useState("all"),r=e.filter(a=>o==="all"||a.category===o).map(a=>t(H,{id:a.id,title:a.title,text:a.text,category:a.category},a.id)),c=r.length;return d("div",{className:"view-notes",children:[d("h3",{children:[t("span",{children:"Select a category\xA0"}),t(w,{options:["all",...n],onSelection:a=>{l(a)}})]}),t("h1",{children:c===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":c===1?"You have only 1 note!":`You have ${c} notes!`}),c>0&&t("div",{className:"view-notes__container",children:r})]})}function A(e){return d("div",{className:"note-item-edit",children:[t("h2",{title:e.title,children:e.title}),e.category!==V[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function U({note:e,closeEditMode:n}){const o=s.exports.useContext(R),l=s.exports.useContext(v),r=s.exports.useContext(b).getCategories(),c=s.exports.useRef(null),[a,i]=s.exports.useState(e.category),h=s.exports.useRef(null),[m,u]=s.exports.useState(e.title),x=s.exports.useRef(null),[p,y]=s.exports.useState(e.text),N=m!==e.title||a!==e.category||p!==e.text;function S(f){f.preventDefault();const C={title:h.current.value,category:a,text:x.current.value,id:e.id};(C.title!==e.title||C.category!==e.category||C.text!==e.text)&&(l.modifyNote(C),o.showNotification("Note changed !"))}function _(){var f;h.current.value=e.title,u(e.title),x.current.value=e.text,y(e.text),(f=c.current)==null||f.resetSelectValue(),i(e.category)}return d(T,{closePanel:n,plusClass:"panel-max-extended",children:[t("h2",{children:"Edit note "}),d("form",{onSubmit:S,children:[t(E,{ref:h,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title,onChangeHandler:u}),d("div",{className:"field",children:["Change the category",t(w,{options:r,defaultOption:e.category,onSelection:f=>{i(f)},ref:c})]}),t(I,{name:"textNote",ref:x,value:e.text,onChangeHandler:y}),d("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",disabled:!N,children:"Save"}),t("button",{type:"button",onClick:_,className:"btn-blue red",title:"Reset to the last saved content",disabled:!N,children:"Discard changes"})]})]})]})}function W(e){const n=s.exports.useContext(v),o=s.exports.useRef(null);function l(){var c;(c=o.current)==null||c.closeBackdrop()}function r(){n.deleteNoteById(e.id),l()}return d(T,{closePanel:e.closeDeleteForm,plusClass:"panel-mind-extended",ref:o,children:[t("h1",{children:"Do you really want to delete this note?"}),d("div",{children:[t("button",{className:"confirmation-btn",onClick:r,children:"Yes"}),t("button",{className:"confirmation-btn btn-no",onClick:l,children:"No"})]})]})}const K=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(U,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(W,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function q(){const[e,n]=s.exports.useReducer(K,void 0),o=k(s.exports.useContext(v).getNotes());function l(i){n({type:1,item:i,closeEditMode:c})}function r(i){n({type:2,item:i,closeEditMode:c})}function c(){n({type:0})}const a=o.map((i,h)=>t(A,{title:i.title,category:i.category,text:i.text,modifyItem:()=>{l(i)},deleteItem:()=>{r(i)}},h));return d("div",{className:"edit-note-container",children:[e,t("h2",{children:o.length===0?"You have no notes to edit .":o.length===1?"You have only 1 note .":"You have "+o.length.toString()+" notes that can be modified ."}),o.length>0&&t("div",{className:"notes-container",children:a})]})}const z=[{noteState:g.viewNotes,component:t(j,{})},{noteState:g.createNote,component:t($,{})},{noteState:g.editNote,component:t(q,{})}];function G({currentStatus:e}){const n=z.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function ee(){const[e,n]=s.exports.useState({navNotesState:g.viewNotes});function o(l){n({navNotesState:l})}return d("section",{className:"note-container",children:[t(F,{initialNavState:e.navNotesState,setNavNotesState:o}),t(G,{currentStatus:e.navNotesState})]})}export{ee as default};
