import{r as s,j as t,a as d,N as v,b as I,C,R as k,F as E,c as D,T as _}from"./index.92a6237d.js";import{T as b}from"./TextArea.3257706e.js";import{I as w}from"./InputText.a4a473f5.js";import{P as T}from"./PanelWithBackdrop.18b85123.js";var g=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(g||{});const M=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function O(e){const[n,o]=s.exports.useState(()=>e.initialNavState),a=s.exports.useId();function r(l){const{currentTarget:i}=l,h=+i.name;n!==h&&(e.setNavNotesState(h),o(h))}const c=M.map((l,i)=>t("button",{className:n===l.btnValue?"note-nav__selected":"",name:l.btnValue.toString(),onClick:r,children:l.navTitle},`${a}-${i}`));return t("section",{className:"note-nav",children:c})}let V=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function F(e,n){var f;const[o,a]=s.exports.useState((f=e.defaultOption)!=null?f:e.options[0]),[r,c]=s.exports.useState(!1),l=s.exports.useId();s.exports.useImperativeHandle(n,()=>({resetSelectValue(){var u;a((u=e.defaultOption)!=null?u:e.options[0])}}));function i(){c(u=>!u)}function h(u){const N=u.target.value;N!==o&&(a(N),e.onSelection(N)),c(!1)}return d("div",{className:"select-interactive",children:[t("div",{className:`select-interactive__ctn ${r?"select-interactive__ctn--open":""}`,onClick:i,title:o.toString(),role:"button",tabIndex:0,onBlur:()=>c(!1),children:o}),t("div",{className:`select-interactive__options ${r?"select-interactive__options--open":""}`,children:e.options.map((u,N)=>t("button",{type:"button",value:u,onClick:h,title:u,className:u===o?"selected":"",children:u},`${l}-${N}`))})]})}const S=s.exports.forwardRef(F);function P(){const e=s.exports.useContext(v),n=s.exports.useContext(I),o=s.exports.useContext(C).getCategories(),a=s.exports.useRef(null),[r,c]=s.exports.useState("none"),l=s.exports.useRef(null),[i,h]=s.exports.useState(""),f=s.exports.useRef(null),[u,N]=s.exports.useState("");function p(){var m;h(""),l.current.value="",N(""),f.current.value="",c("none"),(m=a.current)==null||m.resetSelectValue()}function y(m){m.preventDefault();const x={title:i,category:r,text:u,id:V()};n.showNotification("Note added !"),e.addNote(x),p()}return d("div",{className:"create-note-container",children:[t("h1",{children:"Create a note"}),d("form",{onSubmit:y,children:[t(w,{ref:l,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30,onChangeHandler:h}),d("div",{className:"field",children:["Choose a category"," ",t(S,{options:o,onSelection:m=>{c(m)},ref:a})]}),t(b,{name:"textNote",ref:f,onChangeHandler:N}),d("div",{className:"field-group-btns",children:[t("button",{type:"submit",className:"btn-blue",disabled:i.length<3,children:"Save"}),t("button",{type:"button",className:"btn-blue red",onClick:p,disabled:i.length===0&&r==="none"&&u==="",children:"Discard"})]})]})]})}function Y(e){const{title:n,category:o,text:a}=e.note;s.exports.useRef(null);const r=a.split(`
`).map((c,l)=>d(k.Fragment,{children:[c,t("br",{})]},l));return d(T,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:r})]})}function $(e){const[n,o]=s.exports.useState(!1);function a(){o(!0)}function r(){o(!1)}return d(E,{children:[n&&t(Y,{note:e,closeNote:r}),d("div",{className:"note-item",onClick:a,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category.length>0&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function L(e,n){const o=e.category==="none"?"":e.category,a=n.category==="none"?"":n.category;return o>a?1:o<a?-1:e.title>n.title?1:e.title<n.title?-1:0}function R(e){return e.sort(L)}function B(){const e=R(s.exports.useContext(v).getNotes()),n=s.exports.useContext(C).getCategories(),[o,a]=s.exports.useState("all"),r=e.filter(l=>o==="all"||l.category===o).map(l=>t($,{id:l.id,title:l.title,text:l.text,category:l.category},l.id)),c=r.length;return d("div",{className:"view-notes",children:[d("h3",{children:[t("span",{children:"Select a category\xA0"}),t(S,{options:["all",...n],onSelection:l=>{a(l)}})]}),t("h1",{children:c===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":c===1?"You have only 1 note!":`You have ${c} notes!`}),c>0&&t("div",{className:"view-notes__container",children:r})]})}function j(e){return d("div",{className:"note-item-edit",children:[t("h2",{title:e.title,children:e.title}),e.category!==D[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function A({note:e,closeEditMode:n}){const[o,a]=s.exports.useState(!1),r=s.exports.useContext(v),c=s.exports.useContext(C).getCategories(),[l,i]=s.exports.useState(e.category),h=s.exports.useRef(null),f=s.exports.useRef(null),u=s.exports.useRef(null);function N(m){m.preventDefault();const x={title:f.current.value,category:l,text:u.current.value,id:e.id};(x.title!==e.title||x.category!==e.category||x.text!==e.text)&&(r.modifyNote(x),a(!0))}function p(){a(!1)}function y(){var m;f.current.value=e.title,u.current.value=e.text,i(e.category),(m=h.current)==null||m.resetSelectValue()}return d(T,{closePanel:n,plusClass:"panel-max-extended",children:[o&&t(_,{hideMessage:p,durationSeconds:2.2,children:"Note changed !"}),t("h2",{children:"Edit note "}),d("form",{onSubmit:N,children:[t(w,{ref:f,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title}),d("div",{className:"field",children:["Change the category",t(S,{options:c,defaultOption:e.category,onSelection:m=>{i(m)},ref:h})]}),t(b,{name:"textNote",ref:u,value:e.text}),d("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",children:"Save"}),t("button",{type:"button",onClick:y,className:"btn-blue red",title:"Reset to the last saved content",children:"Discard changes"})]})]})]})}function H(e){const n=s.exports.useRef(null),o=s.exports.useContext(v);function a(){n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}function r(){o.deleteNoteById(e.id),n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}return t("div",{className:"backdrop",onClick:a,children:d("div",{className:"delete-form",ref:n,onClick:c=>c.stopPropagation(),children:[t("button",{className:"close-btn",onClick:a,children:"\xD7"}),t("h2",{children:"Do you really want to delete this note ?"}),d("div",{children:[t("button",{className:"del-btn",onClick:r,children:"Yes"}),t("button",{className:"del-btn btn-no",onClick:a,children:"No"})]})]})})}const U=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(A,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(H,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function W(){const[e,n]=s.exports.useReducer(U,void 0),o=R(s.exports.useContext(v).getNotes());function a(i){n({type:1,item:i,closeEditMode:c})}function r(i){n({type:2,item:i,closeEditMode:c})}function c(){n({type:0})}const l=o.map((i,h)=>t(j,{title:i.title,category:i.category,text:i.text,modifyItem:()=>{a(i)},deleteItem:()=>{r(i)}},h));return d("div",{className:"edit-note-container",children:[e,t("h2",{children:o.length===0?"You have no notes to edit .":o.length===1?"You have only 1 note .":"You have "+o.length.toString()+" notes that can be modified ."}),o.length>0&&t("div",{className:"notes-container",children:l})]})}const K=[{noteState:g.viewNotes,component:t(B,{})},{noteState:g.createNote,component:t(P,{})},{noteState:g.editNote,component:t(W,{})}];function q({currentStatus:e}){const n=K.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function X(){const[e,n]=s.exports.useState({navNotesState:g.viewNotes});function o(a){n({navNotesState:a})}return d("section",{className:"note-container",children:[t(O,{initialNavState:e.navNotesState,setNavNotesState:o}),t(q,{currentStatus:e.navNotesState})]})}export{X as default};
