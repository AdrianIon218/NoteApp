import{r as s,j as t,a as d,N as p,b,C as y,R as k,F as E,c as D}from"./index.da599fb6.js";import{T as S}from"./TextArea.457f7984.js";import{I as w}from"./InputText.8713bf6c.js";import{P as T}from"./PanelWithBackdrop.39cd9ab4.js";var v=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(v||{});const _=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function O(e){const[n,o]=s.exports.useState(()=>e.initialNavState),a=s.exports.useId();function r(l){const{currentTarget:i}=l,h=+i.name;n!==h&&(e.setNavNotesState(h),o(h))}const c=_.map((l,i)=>t("button",{className:n===l.btnValue?"note-nav__selected":"",name:l.btnValue.toString(),onClick:r,children:l.navTitle},`${a}-${i}`));return t("section",{className:"note-nav",children:c})}let V=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function F(e,n){var N;const[o,a]=s.exports.useState((N=e.defaultOption)!=null?N:e.options[0]),[r,c]=s.exports.useState(!1),l=s.exports.useId();s.exports.useImperativeHandle(n,()=>({resetSelectValue(){var u;a((u=e.defaultOption)!=null?u:e.options[0])}}));function i(){c(u=>!u)}function h(u){const m=u.target.value;m!==o&&(a(m),e.onSelection(m)),c(!1)}return d("div",{className:"select-interactive",children:[t("div",{className:`select-interactive__ctn ${r?"select-interactive__ctn--open":""}`,onClick:i,title:o.toString(),role:"button",tabIndex:0,onBlur:()=>c(!1),children:o}),t("div",{className:`select-interactive__options ${r?"select-interactive__options--open":""}`,children:e.options.map((u,m)=>t("button",{type:"button",value:u,onClick:h,title:u,className:u===o?"selected":"",children:u},`${l}-${m}`))})]})}const C=s.exports.forwardRef(F);function M(){const e=s.exports.useContext(p),n=s.exports.useContext(b),o=s.exports.useContext(y).getCategories(),a=s.exports.useRef(null),[r,c]=s.exports.useState("none"),l=s.exports.useRef(null),[i,h]=s.exports.useState(""),N=s.exports.useRef(null),[u,m]=s.exports.useState("");function x(){var g;h(""),l.current.value="",m(""),N.current.value="",c("none"),(g=a.current)==null||g.resetSelectValue()}function f(g){g.preventDefault();const I={title:i,category:r,text:u,id:V()};n.showNotification("Note added !"),e.addNote(I),x()}return d("div",{className:"create-note-container",children:[t("h1",{children:"Create a note"}),d("form",{onSubmit:f,children:[t(w,{ref:l,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30,onChangeHandler:h}),d("div",{className:"field",children:["Choose a category"," ",t(C,{options:o,onSelection:g=>{c(g)},ref:a})]}),t(S,{name:"textNote",ref:N,onChangeHandler:m}),d("div",{className:"field-group-btns",children:[t("button",{type:"submit",className:"btn-blue",disabled:i.length<3,children:"Save"}),t("button",{type:"button",className:"btn-blue red",onClick:x,disabled:i.length===0&&r==="none"&&u==="",children:"Discard"})]})]})]})}function P(e){const{title:n,category:o,text:a}=e.note;s.exports.useRef(null);const r=a.split(`
`).map((c,l)=>d(k.Fragment,{children:[c,t("br",{})]},l));return d(T,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:r})]})}function Y(e){const[n,o]=s.exports.useState(!1);function a(){o(!0)}function r(){o(!1)}return d(E,{children:[n&&t(P,{note:e,closeNote:r}),d("div",{className:"note-item",onClick:a,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category.length>0&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function $(e,n){const o=e.category==="none"?"":e.category,a=n.category==="none"?"":n.category;return o>a?1:o<a?-1:e.title>n.title?1:e.title<n.title?-1:0}function R(e){return e.sort($)}function L(){const e=R(s.exports.useContext(p).getNotes()),n=s.exports.useContext(y).getCategories(),[o,a]=s.exports.useState("all"),r=e.filter(l=>o==="all"||l.category===o).map(l=>t(Y,{id:l.id,title:l.title,text:l.text,category:l.category},l.id)),c=r.length;return d("div",{className:"view-notes",children:[d("h3",{children:[t("span",{children:"Select a category\xA0"}),t(C,{options:["all",...n],onSelection:l=>{a(l)}})]}),t("h1",{children:c===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":c===1?"You have only 1 note!":`You have ${c} notes!`}),c>0&&t("div",{className:"view-notes__container",children:r})]})}function B(e){return d("div",{className:"note-item-edit",children:[t("h2",{title:e.title,children:e.title}),e.category!==D[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function j({note:e,closeEditMode:n}){const o=s.exports.useContext(b),a=s.exports.useContext(p),r=s.exports.useContext(y).getCategories(),[c,l]=s.exports.useState(e.category),i=s.exports.useRef(null),h=s.exports.useRef(null),N=s.exports.useRef(null);function u(x){x.preventDefault();const f={title:h.current.value,category:c,text:N.current.value,id:e.id};(f.title!==e.title||f.category!==e.category||f.text!==e.text)&&(a.modifyNote(f),o.showNotification("Note changed !"))}function m(){var x;h.current.value=e.title,N.current.value=e.text,l(e.category),(x=i.current)==null||x.resetSelectValue()}return d(T,{closePanel:n,plusClass:"panel-max-extended",children:[t("h2",{children:"Edit note "}),d("form",{onSubmit:u,children:[t(w,{ref:h,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title}),d("div",{className:"field",children:["Change the category",t(C,{options:r,defaultOption:e.category,onSelection:x=>{l(x)},ref:i})]}),t(S,{name:"textNote",ref:N,value:e.text}),d("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",children:"Save"}),t("button",{type:"button",onClick:m,className:"btn-blue red",title:"Reset to the last saved content",children:"Discard changes"})]})]})]})}function A(e){const n=s.exports.useRef(null),o=s.exports.useContext(p);function a(){n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}function r(){o.deleteNoteById(e.id),n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}return t("div",{className:"backdrop",onClick:a,children:d("div",{className:"delete-form",ref:n,onClick:c=>c.stopPropagation(),children:[t("button",{className:"close-btn",onClick:a,children:"\xD7"}),t("h2",{children:"Do you really want to delete this note ?"}),d("div",{children:[t("button",{className:"del-btn",onClick:r,children:"Yes"}),t("button",{className:"del-btn btn-no",onClick:a,children:"No"})]})]})})}const H=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(j,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(A,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function U(){const[e,n]=s.exports.useReducer(H,void 0),o=R(s.exports.useContext(p).getNotes());function a(i){n({type:1,item:i,closeEditMode:c})}function r(i){n({type:2,item:i,closeEditMode:c})}function c(){n({type:0})}const l=o.map((i,h)=>t(B,{title:i.title,category:i.category,text:i.text,modifyItem:()=>{a(i)},deleteItem:()=>{r(i)}},h));return d("div",{className:"edit-note-container",children:[e,t("h2",{children:o.length===0?"You have no notes to edit .":o.length===1?"You have only 1 note .":"You have "+o.length.toString()+" notes that can be modified ."}),o.length>0&&t("div",{className:"notes-container",children:l})]})}const W=[{noteState:v.viewNotes,component:t(L,{})},{noteState:v.createNote,component:t(M,{})},{noteState:v.editNote,component:t(U,{})}];function K({currentStatus:e}){const n=W.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function Q(){const[e,n]=s.exports.useState({navNotesState:v.viewNotes});function o(a){n({navNotesState:a})}return d("section",{className:"note-container",children:[t(O,{initialNavState:e.navNotesState,setNavNotesState:o}),t(K,{currentStatus:e.navNotesState})]})}export{Q as default};
