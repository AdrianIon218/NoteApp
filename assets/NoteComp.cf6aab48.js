import{r as d,j as t,L as D,u as p,a as O,b as S,N as x,c as a,R as F,F as k,d as B,e as H}from"./index.c0fa6797.js";import{T as R}from"./TextArea.cb35c8f3.js";import{I as T}from"./InputText.41173a7a.js";import{S as w,P as E}from"./PanelWithBackdrop.d1f379da.js";const M=[{path:"view-notes",navTitle:"My Notes"},{path:"create-note",navTitle:"New Note"},{path:"edit-notes",navTitle:"Edit Notes"}];function P({option:e}){const n=d.exports.useId(),o=M.map((s,i)=>t(D,{className:e===s.path?"note-nav__selected":"",to:"/notes/"+s.path,children:s.navTitle},`${n}-${i}`));return t("section",{className:"note-nav",children:o})}let Y=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function A(){const e=p(),n=O(),o=S().getCategories(),s=d.exports.useRef(null),[i,c]=d.exports.useState(x.NONE),l=d.exports.useRef(null),[N,m]=d.exports.useState(""),g=d.exports.useRef(null),[f,u]=d.exports.useState("");function r(){var h;m(""),l.current.value="",u(""),g.current.value="",c(x.NONE),(h=s.current)==null||h.resetSelectValue()}function y(h){h.preventDefault();const b={title:N,category:i,text:f,id:Y()};n.showNotification("Note added !"),e.addNote(b),r()}return a("div",{className:"create-note-container",children:[t("h1",{children:"Create a note"}),a("form",{onSubmit:y,children:[t(T,{ref:l,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30,onChangeHandler:m}),a("div",{className:"field",children:["Choose a category"," ",t(w,{options:o,onSelection:h=>{c(h)},ref:s})]}),t(R,{name:"textNote",ref:g,onChangeHandler:u}),a("div",{className:"field-group-btns",children:[t("button",{type:"submit",className:"btn-blue",disabled:N.length<3,children:"Save"}),t("button",{type:"button",className:"btn-blue red",onClick:r,disabled:N.length===0&&i===x.NONE&&f==="",children:"Discard"})]})]})]})}function _(e){const{title:n,category:o,text:s}=e.note,i=s.split(`
`).map((c,l)=>a(F.Fragment,{children:[c,t("br",{})]},l));return a(E,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:i})]})}function j(e){const[n,o]=d.exports.useState(!1);function s(){o(!0)}function i(){o(!1)}return a(k,{children:[n&&t(_,{note:e,closeNote:i}),a("div",{className:"note-item",onClick:s,children:[t("h2",{title:e.title,children:e.title}),e.category!==x.NONE&&e.category.length>0&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function V(e,n){const o=e.category===x.NONE?"":e.category,s=n.category===x.NONE?"":n.category;return o>s?1:o<s?-1:e.title>n.title?1:e.title<n.title?-1:0}function L(e){return e.sort(V)}function W(){const e=L(p().getNotes()),n=S().getCategories(),[o,s]=d.exports.useState("all"),i=e.filter(l=>o==="all"||l.category===o).map(l=>t(j,{id:l.id,title:l.title,text:l.text,category:l.category},l.id)),c=i.length;return a("div",{className:"view-notes",children:[e.length>0&&a("h3",{children:[t("span",{children:"Select a category\xA0"}),t(w,{options:["all",...n],onSelection:l=>{s(l)}})]}),t("h1",{children:c===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":c===1?"You have only 1 note!":`You have ${c} notes!`}),c>0&&t("div",{className:"view-notes__container",children:i})]})}function $(e){var n,o;return a("div",{className:"note-item-edit",children:[e.numOfFirstLetersToHighlight?a("h2",{title:e.title,children:[t("span",{className:"text-highlighted",children:(n=e.title)==null?void 0:n.slice(0,e.numOfFirstLetersToHighlight)}),(o=e.title)==null?void 0:o.slice(e.numOfFirstLetersToHighlight)]}):t("h2",{title:e.title,children:e.title}),e.category!==x.NONE&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function U({note:e,closeEditMode:n}){const o=O(),s=p(),i=S().getCategories(),c=d.exports.useRef(null),[l,N]=d.exports.useState(e.category),m=d.exports.useRef(null),[g,f]=d.exports.useState(e.title),u=d.exports.useRef(null),[r,y]=d.exports.useState(e.text),h=g!==e.title||l!==e.category||r!==e.text;function b(v){v.preventDefault();const C={title:m.current.value,category:l,text:u.current.value,id:e.id};(C.title!==e.title||C.category!==e.category||C.text!==e.text)&&(s.modifyNote(C),o.showNotification("Note changed !"))}function I(){var v;m.current.value=e.title,f(e.title),u.current.value=e.text,y(e.text),(v=c.current)==null||v.resetSelectValue(),N(e.category)}return a(E,{closePanel:n,plusClass:"panel-max-extended",children:[t("h2",{children:"Edit note "}),a("form",{onSubmit:b,children:[t(T,{ref:m,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title,onChangeHandler:f}),a("div",{className:"field",children:["Change the category",t(w,{options:i,defaultOption:e.category,onSelection:v=>{N(v)},ref:c})]}),t(R,{name:"textNote",ref:u,value:e.text,onChangeHandler:y}),a("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",disabled:!h,children:"Save"}),t("button",{type:"button",onClick:I,className:"btn-blue red",title:"Reset to the last saved content",disabled:!h,children:"Discard changes"})]})]})]})}function q(e){const n=p(),o=d.exports.useRef(null);function s(){var c;(c=o.current)==null||c.closeBackdrop()}function i(){n.deleteNoteById(e.id),s()}return a(E,{closePanel:e.closeDeleteForm,plusClass:"panel-mind-extended",ref:o,children:[t("h1",{children:"Do you really want to delete this note?"}),a("div",{children:[t("button",{className:"confirmation-btn",onClick:i,children:"Yes"}),t("button",{className:"confirmation-btn btn-no",onClick:s,children:"No"})]})]})}const z=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(U,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(q,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function G(){const[e,n]=d.exports.useReducer(z,void 0),[o,s]=d.exports.useState(""),i=L(p().getNotes()),c=i.length,l=o.length;function N(r){n({type:1,item:r,closeEditMode:g})}function m(r){n({type:2,item:r,closeEditMode:g})}function g(){n({type:0})}const f=o.toLowerCase(),u=i.filter(r=>r.title.toLowerCase().startsWith(f)).map((r,y)=>t($,{title:r.title,numOfFirstLetersToHighlight:l,category:r.category,text:r.text,modifyItem:()=>{N(r)},deleteItem:()=>{m(r)}},y));return a("div",{className:"edit-note-container",children:[e,c===0&&t("h2",{children:"You don't have any notes to edit!"}),c>3&&t(T,{required:!1,text:"Search the note by name",onChangeHandler:r=>{s(r)}}),u.length>0&&t("div",{className:"notes-container",children:u}),u.length===0&&l>0&&t("h2",{children:"You don't have any note with this name!"})]})}const J=[{path:"view-notes",component:t(W,{})},{path:"create-note",component:t(A,{})},{path:"edit-notes",component:t(G,{})}];function K({option:e}){const n=J.filter(o=>o.path===e)[0];return t("section",{className:"note-box",children:n.component})}const Q=["view-notes","create-note","edit-notes"];function ne(){const{option:e}=B();return e===void 0||!Q.includes(e)?t(H,{replace:!0,to:"/page-not-found"}):a("section",{className:"note-container",children:[t(P,{option:e}),t(K,{option:e})]})}export{ne as default};
