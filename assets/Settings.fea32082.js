import{r as t,C as f,b as n,j as e,F as C,T as S,a as V,N as w,c as v}from"./index.595f0ee3.js";import{S as B,P as F}from"./PanelWithBackdrop.f855e30c.js";import{I as T}from"./InputText.bab79f54.js";function I(o){var l;const a=t.exports.useContext(f);return n("fieldset",{className:"categories-group",children:[e("legend",{children:(l=o.title)!=null?l:"Current categories"}),e("div",{className:"categories-flex",children:a.getCategories().map((s,c)=>e("div",{children:s},c))})]})}function M(){const o=t.exports.useRef(),a=t.exports.useContext(f),[l,s]=t.exports.useState(),[c,r]=t.exports.useState(!1);function m(h){h.preventDefault();const u=o.current.value.trim();u.length>0&&a.addCategory(u)&&(o.current.value="",s(n(S,{hideMessage:()=>s(void 0),durationSeconds:1,children:["Category added"," "]})))}return n(C,{children:[l,n("form",{onSubmit:m,className:"flex-col-ctn",children:[e("h2",{className:"txt-center",style:{margin:"5px"},children:"Add a new category"}),e(T,{text:"New category name",customText:"The category must be unique and between 3 and 30 characters !",ref:o,minLength:3,maxLength:31,onChangeHandler:h=>{r(h.length>=3)}}),e(I,{}),e("button",{type:"submit",className:"btn-green",disabled:!c,children:"Save"})]})]})}const L="choose";function A(){const o=t.exports.useContext(f),a=o.getCategories().filter(u=>u!=="none"&&u!=="important"),l=t.exports.useContext(V),s=t.exports.useContext(w),[c,r]=t.exports.useState(""),m=t.exports.useRef(null);function h(u){var g;u.preventDefault(),s.getNotes().filter(d=>d.category===c).forEach(d=>{s.modifyNote({...d,category:"none"})}),o.deleteCategory(c),l.showNotification("Category deleted !","warning"),r(""),(g=m.current)==null||g.resetSelectValue()}return n("div",{className:"flex-col-ctn",children:[a.length!==0?e("form",{onSubmit:h,children:n("div",{className:"flex-center",children:[e("h2",{className:"txt-center",children:"Select a category to delete"}),e(B,{options:a,onSelection:r,defaultOption:L,ref:m}),e("button",{type:"submit",className:"btn-red",disabled:c==="",children:"Delete category"})]})}):e("h2",{className:"txt-center",children:"You don't have any category to delete!"}),n("div",{className:"rules-ctn",children:[e("h3",{className:"txt-red",children:"Rules :"}),n("ol",{children:[e("li",{children:'You cannot delete the "none" or "important" category.'}),e("li",{children:'Category "none" will be associated for cards whose category is deleted.'})]})]})]})}function $({labelMessage:o,valueDefault:a,isNeccessary:l},s){const c=t.exports.useContext(f),[r,m]=t.exports.useState(!0),[h,u]=t.exports.useState([]),g=t.exports.useRef(null),[d,p]=t.exports.useState("no-display"),x=()=>{switch(d){case"no-display":p("animation-go-down");break;case"animation-go-down":p("animation-go-up");break;case"animation-go-up":p("animation-go-down");break}},y=i=>{g.current.innerText=i,g.current.name=i};let D=t.exports.useMemo(()=>e(C,{children:c.getCategories().map((i,R)=>{const N=h.includes(i.trim());return n("button",{type:"button",className:N?"btn-blocked":void 0,onClick:N?void 0:()=>y(i),children:[" ",i," "]},R)})}),[r,h]);t.exports.useImperativeHandle(s,()=>({getSelectValue(){return g.current.name},resetSelectValue(){y("")},setValue(i){c.getCategories().indexOf(i)!==-1&&y(i==="none"?"":i)},updateCategory(){m(i=>!i)},blockCategories(i){u([...i])}}),[]);const k=()=>{d==="animation-go-down"&&p("animation-go-up")},b=t.exports.useId();return n("div",{className:"field",children:[n("label",{htmlFor:b,className:"label-dropdown",children:[o,l?e("span",{style:{color:"red"},children:"*"}):""]}),n("div",{className:"btnWithDropDown",onBlur:()=>k(),children:[e("button",{type:"button",id:b,ref:g,name:a||v[0],className:`btn-category ${d==="animation-go-down"?"btn-category-active":""}`,onClick:x,children:a}),e("div",{className:`dropdown ${d}`,children:D})]})]})}const E=t.exports.forwardRef($);function P(){const o=t.exports.useRef(),a=t.exports.useRef(),l=t.exports.useContext(f),s=t.exports.useContext(w),[c,r]=t.exports.useState(),[m,h]=t.exports.useState(!1);t.exports.useLayoutEffect(()=>{o.current.blockCategories(v)},[]);function u(g){g.preventDefault();const d=o.current.getSelectValue(),p=a.current.value.trim();d!="none"&&l.replaceCategory(d,p)&&(s.getNotes().filter(x=>x.category===d).forEach(x=>{s.modifyNote({...x,category:p})}),o.current.setValue("none"),o.current.updateCategory(),a.current.value="",r(e(S,{hideMessage:()=>r(void 0),durationSeconds:1.5,children:"Category changed !"})))}return n("div",{className:"flex-col-ctn",children:[c,e("h2",{className:"txt-center",children:"Change the name of a category"}),n("form",{onSubmit:u,children:[e(E,{labelMessage:"Select category",ref:o,isNeccessary:!0}),e("h3",{className:"txt-red",style:{marginLeft:"0px",marginBottom:"5px"},children:"Rules :"}),n("ol",{className:"small-margin medium-margin-bot",children:[e("li",{children:'You cannot modify the "none" or "important" category .'}),e("li",{children:"There cannot be two categories with the same name ."})]}),e(T,{text:"Insert a name",customText:"The category must be between 3 and 30 characters !",ref:a,minLength:3,maxLength:31,onChangeHandler:g=>{h(g.length>=3)}}),e("button",{type:"submit",className:"btn-green",disabled:!m,style:{marginTop:"1rem"},children:"Save"})]})]})}const j=[{btnText:"Add a new category",categoryState:0},{btnText:"Delete a category",categoryState:1},{btnText:"Modify a category",categoryState:2}];function W(){const[o,a]=t.exports.useState(),l=t.exports.useId(),s=()=>a(void 0);function c(r){a(n(F,{closePanel:s,children:[r===0&&e(M,{}),r===1&&e(A,{}),r===2&&e(P,{})]}))}return n(C,{children:[o,e("div",{className:"settings-panel",children:n("div",{className:"forms-panel",children:[e("h2",{children:"Categories settings"}),j.map((r,m)=>e("button",{className:"btn-to-form",onClick:()=>c(r.categoryState),children:r.btnText},`${l}-${m}`))]})})]})}export{W as default};
