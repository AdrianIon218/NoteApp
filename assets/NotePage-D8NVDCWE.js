import{r as i,N as v,j as t,L,s as w,G as O,u as T,a as j,b as g,V as b,c as k,R as P,m as F,d as B,e as H,f as M}from"./index-C4vhbmW1.js";import{T as R}from"./TextArea-C7TDQlzP.js";import{I as C}from"./InputText-Oz158w0A.js";import{S,P as E}from"./PanelWithBackdrop-DQXDVPUQ.js";const A=[{path:v.VIEW_NOTES,navTitle:"My Notes"},{path:v.CREATE_NOTE,navTitle:"New Note"},{path:v.EDIT_NOTES,navTitle:"Edit Notes"}],V=w(O)(({theme:e})=>({display:"flex",flexDirection:"column",rowGap:"1.2em",alignItems:"center",marginTop:"3em",[e.breakpoints.down("lg")]:{marginTop:0}}));function Y({option:e}){const s=i.useId(),n=A.map((o,c)=>t.jsx(L,{className:e===o.path?"note-nav__selected":"",to:"/notes/"+o.path,children:o.navTitle},`${s}-${c}`));return t.jsx(V,{className:"note-nav",children:n})}const _="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let W=(e=21)=>{let s="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)s+=_[n[e]&63];return s};function G(){const e=T(),s=j(d=>d.category.categories),n=i.useRef(null),[o,c]=i.useState(g.NONE),r=i.useRef(null),[a,u]=i.useState(""),f=i.useRef(null),[h,x]=i.useState("");function m(){var d;u(""),r.current.value="",x(""),f.current.value="",c(g.NONE),(d=n.current)==null||d.resetSelectValue()}function l(d){d.preventDefault();const p={title:a,category:o,text:h,id:W()};b.dismiss(),b.success("Note added !"),e(k(p)),m()}return t.jsxs("div",{className:"create-note-container",children:[t.jsx("h1",{children:"Create a note"}),t.jsxs("form",{onSubmit:l,children:[t.jsx(C,{ref:r,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30,onChangeHandler:u}),t.jsxs("div",{className:"field",children:["Choose a category"," ",t.jsx(S,{options:s,onSelection:d=>{c(d)},ref:n})]}),t.jsx(R,{name:"textNote",ref:f,onChangeHandler:x}),t.jsxs("div",{className:"field-group-btns",children:[t.jsx("button",{type:"submit",className:"btn-blue",disabled:a.length<3,children:"Save"}),t.jsx("button",{type:"button",className:"btn-blue red",onClick:m,disabled:a.length===0&&o===g.NONE&&h==="",children:"Discard"})]})]})]})}function $(e){const{title:s,category:n,text:o}=e.note,c=o.split(`
`).map((r,a)=>t.jsxs(P.Fragment,{children:[r,t.jsx("br",{})]},a));return t.jsxs(E,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[n??n!==""?t.jsx("label",{className:"category-label",children:n}):null,t.jsx("h2",{title:s,children:s}),t.jsx("div",{className:"note-text",children:c})]})}function q(e){const[s,n]=i.useState(!1);function o(){n(!0)}function c(){n(!1)}return t.jsxs(t.Fragment,{children:[s&&t.jsx($,{note:e,closeNote:c}),t.jsxs("div",{className:"note-item",onClick:o,children:[t.jsx("h2",{title:e.title,children:e.title}),e.category!==g.NONE&&e.category.length>0&&t.jsx("label",{children:e.category}),t.jsx("div",{children:e.text.split(`
`)[0]})]})]})}function U(e,s){const n=e.category===g.NONE?"":e.category,o=s.category===g.NONE?"":s.category;return n>o?1:n<o?-1:e.title>s.title?1:e.title<s.title?-1:0}function I(e){return e.sort(U)}function J(){const e=j(a=>I(a.notes.notes)),s=j(a=>a.category.categories),[n,o]=i.useState("all"),c=e.filter(a=>n==="all"||a.category===n).map(a=>i.createElement(q,{...a,key:a.id})),r=c.length;return t.jsxs("div",{className:"view-notes",children:[e.length>0&&t.jsxs("h3",{children:[t.jsx("span",{children:"Select a categoryÂ "}),t.jsx(S,{options:["all",...s],onSelection:a=>{o(a)}})]}),t.jsx("h1",{children:r===0?n==="all"?"You don't have any notes!":"You don't have any notes of this category!":r===1?"You have only 1 note!":`You have ${r} notes!`}),r>0&&t.jsx("div",{className:"view-notes__container",children:c})]})}function K(e){var s,n;return t.jsxs("div",{className:"note-item-edit",children:[e.numOfFirstLetersToHighlight?t.jsxs("h2",{title:e.title,children:[t.jsx("span",{className:"text-highlighted",children:(s=e.title)==null?void 0:s.slice(0,e.numOfFirstLetersToHighlight)}),(n=e.title)==null?void 0:n.slice(e.numOfFirstLetersToHighlight)]}):t.jsx("h2",{title:e.title,children:e.title}),e.category!==g.NONE&&t.jsx("label",{children:e.category}),t.jsx("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t.jsx("button",{children:"edit"})}),t.jsx("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t.jsx("button",{className:"delete",children:"delete"})})]})}function Q({note:e,closeEditMode:s}){const n=j(N=>N.category.categories),o=T(),c=i.useRef(null),[r,a]=i.useState(e.category),u=i.useRef(null),[f,h]=i.useState(e.title),x=i.useRef(null),[m,l]=i.useState(e.text),d=f!==e.title||r!==e.category||m!==e.text;function p(N){N.preventDefault();const y={title:u.current.value,category:r,text:x.current.value,id:e.id};(y.title!==e.title||y.category!==e.category||y.text!==e.text)&&(b.dismiss(),o(F(y)),b.success("Note changed !"))}function D(){var N;u.current.value=e.title,h(e.title),x.current.value=e.text,l(e.text),(N=c.current)==null||N.resetSelectValue(),a(e.category)}return t.jsxs(E,{closePanel:s,plusClass:"panel-max-extended",children:[t.jsx("h2",{children:"Edit note "}),t.jsxs("form",{onSubmit:p,children:[t.jsx(C,{ref:u,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title,onChangeHandler:h}),t.jsxs("div",{className:"field",children:["Change the category",t.jsx(S,{options:n,defaultOption:e.category,onSelection:N=>{a(N)},ref:c})]}),t.jsx(R,{name:"textNote",ref:x,value:e.text,onChangeHandler:l}),t.jsxs("div",{className:"field-group-btns",children:[t.jsx("button",{className:"btn-blue",disabled:!d,children:"Save"}),t.jsx("button",{type:"button",onClick:D,className:"btn-blue red",title:"Reset to the last saved content",disabled:!d,children:"Discard changes"})]})]})]})}function X(e){const s=i.useRef(null),n=T();function o(){var r;(r=s.current)==null||r.closeBackdrop()}function c(){n(B(e.id)),o()}return t.jsxs(E,{closePanel:e.closeDeleteForm,plusClass:"panel-mind-extended",ref:s,children:[t.jsx("h1",{children:"Do you really want to delete this note?"}),t.jsxs("div",{children:[t.jsx("button",{className:"confirmation-btn",onClick:c,children:"Yes"}),t.jsx("button",{className:"confirmation-btn btn-no",onClick:o,children:"No"})]})]})}const Z=(e,s)=>{switch(s.type){case 0:return;case 1:return s.item&&s.closeEditMode&&t.jsx(Q,{note:s.item,closeEditMode:s.closeEditMode});case 2:return s.item&&s.closeEditMode&&t.jsx(X,{closeDeleteForm:s.closeEditMode,id:s.item.id})}};function z(){const[e,s]=i.useReducer(Z,void 0),[n,o]=i.useState(""),c=j(l=>I(l.notes.notes)),r=c.length,a=n.length;function u(l){s({type:1,item:l,closeEditMode:h})}function f(l){s({type:2,item:l,closeEditMode:h})}function h(){s({type:0})}const x=n.toLowerCase(),m=c.filter(l=>l.title.toLowerCase().startsWith(x)).map((l,d)=>t.jsx(K,{title:l.title,numOfFirstLetersToHighlight:a,category:l.category,text:l.text,modifyItem:()=>{u(l)},deleteItem:()=>{f(l)}},d));return t.jsxs("div",{className:"edit-note-container",children:[e,r===0&&t.jsx("h2",{children:"You don't have any notes to edit!"}),r>3&&t.jsx(C,{required:!1,text:"Search the note by name",onChangeHandler:l=>{o(l)}}),m.length>0&&t.jsx("div",{className:"notes-container",children:m}),m.length===0&&a>0&&t.jsx("h2",{children:"You don't have any note with this name!"})]})}const ee=[{path:"view-notes",component:t.jsx(J,{})},{path:"create-note",component:t.jsx(G,{})},{path:"edit-notes",component:t.jsx(z,{})}];function te({option:e}){const s=ee.filter(n=>n.path===e)[0];return t.jsx("section",{className:"note-box",children:s.component})}const se=Object.values(v),ne=w(O)(({theme:e})=>({padding:"2rem",display:"flex",flexWrap:"wrap",justifyContent:"space-around",gap:"2rem"}));function ie(){const{option:e}=H();return e===void 0||!se.includes(e)?t.jsx(M,{replace:!0,to:"/page-not-found"}):t.jsxs(ne,{className:"note-container",children:[t.jsx(Y,{option:e}),t.jsx(te,{option:e})]})}export{ie as default};
