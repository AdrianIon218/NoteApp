import{r as t,C as x,a as n,j as e,F as C,T as N,c as f,N as v}from"./index.ed9477d7.js";import{P as B}from"./PanelWithBackdrop.96c1246e.js";import{I as D}from"./InputText.e7ed5717.js";function T(o){var c;const a=t.exports.useContext(x);return n("fieldset",{className:"categories-group",children:[e("legend",{children:(c=o.title)!=null?c:"Current categories"}),e("div",{className:"categories-flex",children:a.getCategories().map((i,l)=>e("div",{children:i},l))})]})}function F(){const o=t.exports.useRef(),a=t.exports.useContext(x),[c,i]=t.exports.useState(),[l,r]=t.exports.useState(!1);function g(m){m.preventDefault();const u=o.current.value.trim();u.length>0&&a.addCategory(u)&&(o.current.value="",i(n(N,{hideMessage:()=>i(void 0),durationSeconds:1,children:["Category added"," "]})))}return n(C,{children:[c,n("form",{onSubmit:g,className:"form-display-flex",children:[e("h2",{className:"txt-center",style:{margin:"5px"},children:"Add a new category"}),e(D,{text:"New category name",customText:"The category must be unique and between 3 and 30 characters !",ref:o,minLength:3,maxLength:31,onChangeHandler:m=>{r(m.length>=3)}}),e(T,{}),e("button",{type:"submit",className:"btn-green",disabled:!l,children:"Save"})]})]})}function I({labelMessage:o,valueDefault:a,isNeccessary:c},i){const l=t.exports.useContext(x),[r,g]=t.exports.useState(!0),[m,u]=t.exports.useState([]),d=t.exports.useRef(null),[h,p]=t.exports.useState("no-display"),y=()=>{switch(h){case"no-display":p("animation-go-down");break;case"animation-go-down":p("animation-go-up");break;case"animation-go-up":p("animation-go-down");break}},b=s=>{d.current.innerText=s,d.current.name=s};let V=t.exports.useMemo(()=>e(C,{children:l.getCategories().map((s,R)=>{const w=m.includes(s.trim());return n("button",{type:"button",className:w?"btn-blocked":void 0,onClick:w?void 0:()=>b(s),children:[" ",s," "]},R)})}),[r,m]);t.exports.useImperativeHandle(i,()=>({getSelectValue(){return d.current.name},resetSelectValue(){b("")},setValue(s){l.getCategories().indexOf(s)!==-1&&b(s==="none"?"":s)},updateCategory(){g(s=>!s)},blockCategories(s){u([...s])}}),[]);const M=()=>{h==="animation-go-down"&&p("animation-go-up")},S=t.exports.useId();return n("div",{className:"field",children:[n("label",{htmlFor:S,className:"label-dropdown",children:[o,c?e("span",{style:{color:"red"},children:"*"}):""]}),n("div",{className:"btnWithDropDown",onBlur:()=>M(),children:[e("button",{type:"button",id:S,ref:d,name:a||f[0],className:`btn-category ${h==="animation-go-down"?"btn-category-active":""}`,onClick:y,children:a}),e("div",{className:`dropdown ${h}`,children:V})]})]})}const k=t.exports.forwardRef(I);function L(){var g;const o=t.exports.useRef(),a=t.exports.useContext(x),c=t.exports.useContext(v),[i,l]=t.exports.useState();t.exports.useLayoutEffect(()=>{o.current.blockCategories(f)},[]);function r(m){m.preventDefault();const u=o.current.getSelectValue();f.indexOf(u)===-1&&a.getCategories().includes(u)&&(a.deleteCategory(u),c.getNotes().filter(d=>d.category===u).forEach(d=>{c.modifyNote({...d,category:"none"})}),o.current.setValue("none"),o.current.updateCategory(),l(e(N,{hideMessage:()=>l(void 0),durationSeconds:1.5,children:"Category deleted !"})))}return n(C,{children:[i,e("div",{className:"div-scroll-Y",children:n("div",{className:"form-display-flex",children:[e("h2",{className:"txt-center",children:"Select a category to delete"}),n("form",{onSubmit:r,children:[e(k,{labelMessage:"Select category",ref:o,isNeccessary:!0}),e("h3",{style:{marginBottom:"5px"},className:"txt-red",children:"Rules :"}),n("ol",{className:"small-margin",children:[e("li",{children:'You cannot delete the "none" or "important" category.'}),e("li",{children:'Category "none" will be associated for cards whose category is deleted.'})]}),e("button",{type:"submit",className:"btn-red",disabled:f.includes((g=o.current)==null?void 0:g.getSelectValue()),children:"Delete category"}),e(T,{})]})]})})]})}function A(){const o=t.exports.useRef(),a=t.exports.useRef(),c=t.exports.useContext(x),i=t.exports.useContext(v),[l,r]=t.exports.useState(),[g,m]=t.exports.useState(!1);t.exports.useLayoutEffect(()=>{o.current.blockCategories(f)},[]);function u(d){d.preventDefault();const h=o.current.getSelectValue(),p=a.current.value.trim();h!="none"&&c.replaceCategory(h,p)&&(i.getNotes().filter(y=>y.category===h).forEach(y=>{i.modifyNote({...y,category:p})}),o.current.setValue("none"),o.current.updateCategory(),a.current.value="",r(e(N,{hideMessage:()=>r(void 0),durationSeconds:1.5,children:"Category changed !"})))}return n("div",{className:"form-display-flex",children:[l,e("h2",{className:"txt-center",children:"Change the name of a category"}),n("form",{onSubmit:u,children:[e(k,{labelMessage:"Select category",ref:o,isNeccessary:!0}),e("h3",{className:"txt-red",style:{marginLeft:"0px",marginBottom:"5px"},children:"Rules :"}),n("ol",{className:"small-margin medium-margin-bot",children:[e("li",{children:'You cannot modify the "none" or "important" category .'}),e("li",{children:"There cannot be two categories with the same name ."})]}),e(D,{text:"Insert a name",customText:"The category must be between 3 and 30 characters !",ref:a,minLength:3,maxLength:31,onChangeHandler:d=>{m(d.length>=3)}}),e("button",{type:"submit",className:"btn-green",disabled:!g,style:{marginTop:"1rem"},children:"Save"})]})]})}const E=[{btnText:"Add a new category",categoryState:0},{btnText:"Delete a category",categoryState:1},{btnText:"Modify a category",categoryState:2}];function H(){const[o,a]=t.exports.useState(),c=t.exports.useId(),i=()=>a(void 0);function l(r){a(n(B,{closePanel:i,children:[r===0&&e(F,{}),r===1&&e(L,{}),r===2&&e(A,{})]}))}return n(C,{children:[o,e("div",{className:"settings-panel",children:n("div",{className:"forms-panel",children:[e("h2",{children:"Categories settings"}),E.map((r,g)=>e("button",{className:"btn-to-form",onClick:()=>l(r.categoryState),children:r.btnText},`${c}-${g}`))]})})]})}export{H as default};
