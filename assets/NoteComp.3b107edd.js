import{r as s,j as t,a as d,N as p,C,R as E,F as D,c as _}from"./index.05032cdf.js";import{T as w}from"./TextArea.9ae9791f.js";import{T,I as R}from"./TemporalNotification.0fe26200.js";import{P as I}from"./PanelWithBackdrop.4258469b.js";var v=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(v||{});const O=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function V(e){const[n,o]=s.exports.useState(()=>e.initialNavState),a=s.exports.useId();function r(l){const{currentTarget:i}=l,h=+i.name;n!==h&&(e.setNavNotesState(h),o(h))}const c=O.map((l,i)=>t("button",{className:n===l.btnValue?"note-nav__selected":"",name:l.btnValue.toString(),onClick:r,children:l.navTitle},`${a}-${i}`));return t("section",{className:"note-nav",children:c})}let F=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function P(e,n){var N;const[o,a]=s.exports.useState((N=e.defaultOption)!=null?N:e.options[0]),[r,c]=s.exports.useState(!1),l=s.exports.useId();s.exports.useImperativeHandle(n,()=>({resetSelectValue(){var u;a((u=e.defaultOption)!=null?u:e.options[0])}}));function i(){c(u=>!u)}function h(u){const m=u.target.value;m!==o&&(a(m),e.onSelection(m)),c(!1)}return d("div",{className:"select-interactive",children:[t("div",{className:`select-interactive__ctn ${r?"select-interactive__ctn--open":""}`,onClick:i,title:o.toString(),role:"button",tabIndex:0,onBlur:()=>c(!1),children:o}),t("div",{className:`select-interactive__options ${r?"select-interactive__options--open":""}`,children:e.options.map((u,m)=>t("button",{type:"button",value:u,onClick:h,title:u,children:u},`${l}-${m}`))})]})}const b=s.exports.forwardRef(P);function Y(){const[e,n]=s.exports.useState(!1),o=s.exports.useContext(p),a=s.exports.useContext(C).getCategories(),r=s.exports.useRef(null),[c,l]=s.exports.useState("none"),i=s.exports.useRef(null),[h,N]=s.exports.useState(""),u=s.exports.useRef(null),[m,y]=s.exports.useState("");function S(){var g;N(""),i.current.value="",y(""),u.current.value="",l("none"),(g=r.current)==null||g.resetSelectValue()}function f(g){if(!e){g.preventDefault();const M={title:h,category:c,text:m,id:F()};o.addNote(M),S(),n(!0)}}function x(){n(!1)}return d("div",{className:"create-note-container",children:[e&&t(T,{hideMessage:x,children:"Note added !"}),t("h1",{children:"Create a note"}),d("form",{onSubmit:f,children:[t(R,{ref:i,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30,onChangeHandler:N}),d("div",{className:"field",children:["Choose a category"," ",t(b,{options:a,onSelection:g=>{l(g)},ref:r})]}),t(w,{name:"textNote",ref:u,onChangeHandler:y}),d("div",{className:"field-group-btns",children:[t("button",{type:"submit",className:"btn-blue",disabled:h.length<3,children:"Save"}),t("button",{type:"button",className:"btn-blue red",onClick:S,disabled:h.length===0&&c==="none"&&m==="",children:"Discard"})]})]})]})}function $(e){const{title:n,category:o,text:a}=e.note;s.exports.useRef(null);const r=a.split(`
`).map((c,l)=>d(E.Fragment,{children:[c,t("br",{})]},l));return d(I,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:r})]})}function L(e){const[n,o]=s.exports.useState(!1);function a(){o(!0)}function r(){o(!1)}return d(D,{children:[n&&t($,{note:e,closeNote:r}),d("div",{className:"note-item",onClick:a,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category.length>0&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function B(e,n){const o=e.category==="none"?"":e.category,a=n.category==="none"?"":n.category;return o>a?1:o<a?-1:e.title>n.title?1:e.title<n.title?-1:0}function k(e){return e.sort(B)}function j(){const e=k(s.exports.useContext(p).getNotes()),n=s.exports.useContext(C).getCategories(),[o,a]=s.exports.useState("all"),r=e.filter(l=>o==="all"||l.category===o).map(l=>t(L,{id:l.id,title:l.title,text:l.text,category:l.category},l.id)),c=r.length;return d("div",{className:"view-notes",children:[d("h3",{children:[t("span",{children:"Select a category\xA0"}),t(b,{options:["all",...n],onSelection:l=>{a(l)}})]}),t("h1",{children:c===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":c===1?"You have only 1 note!":`You have ${c} notes!`}),c>0&&t("div",{className:"view-notes__container",children:r})]})}function A(e){return d("div",{className:"note-item-edit",children:[t("h2",{title:e.title,children:e.title}),e.category!==_[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function H({note:e,closeEditMode:n}){const[o,a]=s.exports.useState(!1),r=s.exports.useContext(p),c=s.exports.useContext(C).getCategories(),[l,i]=s.exports.useState(e.category),h=s.exports.useRef(null),N=s.exports.useRef(null),u=s.exports.useRef(null);function m(f){f.preventDefault();const x={title:N.current.value,category:l,text:u.current.value,id:e.id};(x.title!==e.title||x.category!==e.category||x.text!==e.text)&&(r.modifyNote(x),a(!0))}function y(){a(!1)}function S(){var f;N.current.value=e.title,u.current.value=e.text,i(e.category),(f=h.current)==null||f.resetSelectValue()}return d(I,{closePanel:n,plusClass:"panel-max-extended",children:[o&&t(T,{hideMessage:y,durationSeconds:2.2,children:"Note changed !"}),t("h2",{children:"Edit note "}),d("form",{onSubmit:m,children:[t(R,{ref:N,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title}),d("div",{className:"field",children:["Change the category",t(b,{options:c,defaultOption:e.category,onSelection:f=>{i(f)},ref:h})]}),t(w,{name:"textNote",ref:u,value:e.text}),d("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",children:"Save"}),t("button",{type:"button",onClick:S,className:"btn-blue red",title:"Reset to the last saved content",children:"Discard changes"})]})]})]})}function U(e){const n=s.exports.useRef(null),o=s.exports.useContext(p);function a(){n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}function r(){o.deleteNoteById(e.id),n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}return t("div",{className:"backdrop",onClick:a,children:d("div",{className:"delete-form",ref:n,onClick:c=>c.stopPropagation(),children:[t("button",{className:"close-btn",onClick:a,children:"\xD7"}),t("h2",{children:"Do you really want to delete this note ?"}),d("div",{children:[t("button",{className:"del-btn",onClick:r,children:"Yes"}),t("button",{className:"del-btn btn-no",onClick:a,children:"No"})]})]})})}const W=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(H,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(U,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function K(){const[e,n]=s.exports.useReducer(W,void 0),o=k(s.exports.useContext(p).getNotes());function a(i){n({type:1,item:i,closeEditMode:c})}function r(i){n({type:2,item:i,closeEditMode:c})}function c(){n({type:0})}const l=o.map((i,h)=>t(A,{title:i.title,category:i.category,text:i.text,modifyItem:()=>{a(i)},deleteItem:()=>{r(i)}},h));return d("div",{className:"edit-note-container",children:[e,t("h2",{children:o.length===0?"You have no notes to edit .":o.length===1?"You have only 1 note .":"You have "+o.length.toString()+" notes that can be modified ."}),o.length>0&&t("div",{className:"notes-container",children:l})]})}const q=[{noteState:v.viewNotes,component:t(j,{})},{noteState:v.createNote,component:t(Y,{})},{noteState:v.editNote,component:t(K,{})}];function z({currentStatus:e}){const n=q.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function Z(){const[e,n]=s.exports.useState({navNotesState:v.viewNotes});function o(a){n({navNotesState:a})}return d("section",{className:"note-container",children:[t(V,{initialNavState:e.navNotesState,setNavNotesState:o}),t(z,{currentStatus:e.navNotesState})]})}export{Z as default};
