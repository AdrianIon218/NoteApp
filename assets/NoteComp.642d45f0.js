import{r as s,j as t,a as r,N as p,C as S,R,F as M,c as E}from"./index.845d7d2b.js";import{T as b}from"./TextArea.0c19fe1c.js";import{T as w,I as T}from"./TemporalNotification.e62202a4.js";import{P as I}from"./PanelWithBackdrop.fe2f63ce.js";var v=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(v||{});const D=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function V(e){const[n,o]=s.exports.useState(()=>e.initialNavState),l=s.exports.useId();function d(a){const{currentTarget:i}=a,h=+i.name;n!==h&&(e.setNavNotesState(h),o(h))}const c=D.map((a,i)=>t("button",{className:n===a.btnValue?"note-nav__selected":"",name:a.btnValue.toString(),onClick:d,children:a.navTitle},`${l}-${i}`));return t("section",{className:"note-nav",children:c})}let _=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function O(e,n){var m;const[o,l]=s.exports.useState((m=e.defaultOption)!=null?m:e.options[0]),[d,c]=s.exports.useState(!1),a=s.exports.useId();s.exports.useImperativeHandle(n,()=>({resetSelectValue(){var u;l((u=e.defaultOption)!=null?u:e.options[0])}}));function i(){c(u=>!u)}function h(u){const N=u.target.value;N!==o&&(l(N),e.onSelection(N)),c(!1)}return r("div",{className:"select-interactive",children:[t("div",{className:`select-interactive__ctn ${d?"select-interactive__ctn--open":""}`,onClick:i,title:o.toString(),role:"button",tabIndex:0,onBlur:()=>c(!1),children:o}),t("div",{className:`select-interactive__options ${d?"select-interactive__options--open":""}`,children:e.options.map((u,N)=>t("button",{type:"button",value:u,onClick:h,title:u,children:u},`${a}-${N}`))})]})}const C=s.exports.forwardRef(O);function F(){const[e,n]=s.exports.useState(!1),o=s.exports.useContext(p),l=s.exports.useContext(S).getCategories(),[d,c]=s.exports.useState("none"),a=s.exports.useRef(null),i=s.exports.useRef(null),h=s.exports.useRef(null);function m(){var f;i.current.value="",h.current.value="",c("none"),(f=a.current)==null||f.resetSelectValue()}function u(f){if(!e){f.preventDefault();const y=i.current.value,x=h.current.value,g={title:y,category:d,text:x,id:_()};o.addNote(g),m(),n(!0)}}function N(){n(!1)}return r("div",{className:"create-note-container",children:[e&&t(w,{hideMessage:N,children:"Note added !"}),t("h1",{children:"Create a note"}),r("form",{onSubmit:u,children:[t(T,{ref:i,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30}),r("div",{className:"field",children:["Choose a category"," ",t(C,{options:l,onSelection:f=>{c(f)},ref:a})]}),t(b,{name:"textNote",ref:h}),r("div",{className:"field-group-btns",children:[r("button",{type:"submit",className:"btn-blue",children:[" ","Save"," "]}),r("button",{type:"button",className:"btn-blue red",onClick:m,children:[" ","Discard"," "]})]})]})]})}function P(e){const{title:n,category:o,text:l}=e.note;s.exports.useRef(null);const d=l.split(`
`).map((c,a)=>r(R.Fragment,{children:[c,t("br",{})]},a));return r(I,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:d})]})}function Y(e){const[n,o]=s.exports.useState(!1);function l(){o(!0)}function d(){o(!1)}return r(M,{children:[n&&t(P,{note:e,closeNote:d}),r("div",{className:"note-item",onClick:l,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category.length>0&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function $(e,n){const o=e.category==="none"?"":e.category,l=n.category==="none"?"":n.category;return o>l?1:o<l?-1:e.title>n.title?1:e.title<n.title?-1:0}function k(e){return e.sort($)}function L(){const e=k(s.exports.useContext(p).getNotes()),n=s.exports.useContext(S).getCategories(),[o,l]=s.exports.useState("all"),d=e.filter(a=>o==="all"||a.category===o).map(a=>t(Y,{id:a.id,title:a.title,text:a.text,category:a.category},a.id)),c=d.length;return r("div",{className:"view-notes",children:[r("h3",{children:[t("span",{children:"Select a category\xA0"}),t(C,{options:["all",...n],onSelection:a=>{l(a)}})]}),t("h1",{children:c===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":c===1?"You have only 1 note!":`You have ${c} notes!`}),c>0&&t("div",{className:"view-notes__container",children:d})]})}function B(e){return r("div",{className:"note-item-edit",children:[t("h2",{title:e.title,children:e.title}),e.category!==E[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function j({note:e,closeEditMode:n}){const[o,l]=s.exports.useState(!1),d=s.exports.useContext(p),c=s.exports.useContext(S).getCategories(),[a,i]=s.exports.useState(e.category),h=s.exports.useRef(null),m=s.exports.useRef(null),u=s.exports.useRef(null);function N(x){x.preventDefault();const g={title:m.current.value,category:a,text:u.current.value,id:e.id};(g.title!==e.title||g.category!==e.category||g.text!==e.text)&&(d.modifyNote(g),l(!0))}function f(){l(!1)}function y(){var x;m.current.value=e.title,u.current.value=e.text,i(e.category),(x=h.current)==null||x.resetSelectValue()}return r(I,{closePanel:n,plusClass:"panel-max-extended",children:[o&&t(w,{hideMessage:f,durationSeconds:2.2,children:"Note changed !"}),t("h2",{children:"Edit note "}),r("form",{onSubmit:N,children:[t(T,{ref:m,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title}),r("div",{className:"field",children:["Change the category",t(C,{options:c,defaultOption:e.category,onSelection:x=>{i(x)},ref:h})]}),t(b,{name:"textNote",ref:u,value:e.text}),r("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",children:"Save"}),t("button",{type:"button",onClick:y,className:"btn-blue red",title:"Reset to the last saved content",children:"Discard changes"})]})]})]})}function A(e){const n=s.exports.useRef(null),o=s.exports.useContext(p);function l(){n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}function d(){o.deleteNoteById(e.id),n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}return t("div",{className:"backdrop",onClick:l,children:r("div",{className:"delete-form",ref:n,onClick:c=>c.stopPropagation(),children:[t("button",{className:"close-btn",onClick:l,children:"\xD7"}),t("h2",{children:"Do you really want to delete this note ?"}),r("div",{children:[t("button",{className:"del-btn",onClick:d,children:"Yes"}),t("button",{className:"del-btn btn-no",onClick:l,children:"No"})]})]})})}const U=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(j,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(A,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function W(){const[e,n]=s.exports.useReducer(U,void 0),o=k(s.exports.useContext(p).getNotes());function l(i){n({type:1,item:i,closeEditMode:c})}function d(i){n({type:2,item:i,closeEditMode:c})}function c(){n({type:0})}const a=o.map((i,h)=>t(B,{title:i.title,category:i.category,text:i.text,modifyItem:()=>{l(i)},deleteItem:()=>{d(i)}},h));return r("div",{className:"edit-note-container",children:[e,t("h2",{children:o.length===0?"You have no notes to edit .":o.length===1?"You have only 1 note .":"You have "+o.length.toString()+" notes that can be modified ."}),o.length>0&&t("div",{className:"notes-container",children:a})]})}const H=[{noteState:v.viewNotes,component:t(L,{})},{noteState:v.createNote,component:t(F,{})},{noteState:v.editNote,component:t(W,{})}];function K({currentStatus:e}){const n=H.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function Q(){const[e,n]=s.exports.useState({navNotesState:v.viewNotes});function o(l){n({navNotesState:l})}return r("section",{className:"note-container",children:[t(V,{initialNavState:e.navNotesState,setNavNotesState:o}),t(K,{currentStatus:e.navNotesState})]})}export{Q as default};
