import{r as a,j as t,N as x,a as d,R as k,F as T,C as D,c as M}from"./index.da4ba273.js";import{D as b,F as I}from"./FormWithBackdrop.3cdb3a4d.js";import{T as S}from"./TextArea.e6fd1aae.js";import{T as C,I as p}from"./TemporalNotification.84f0ed54.js";var f=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(f||{});const R=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function V(e){const[n,o]=a.exports.useState(()=>e.initialNavState),s=a.exports.useId();function c(l){const{currentTarget:r}=l,u=+r.name;n!==u&&(e.setNavNotesState(u),o(u))}const i=R.map((l,r)=>t("button",{className:n===l.btnValue?"note-nav__selected":"",name:l.btnValue.toString(),onClick:c,children:l.navTitle},`${s}-${r}`));return t("section",{className:"note-nav",children:i})}let E=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function _(){const[e,n]=a.exports.useState(!1),o=a.exports.useContext(x),s=a.exports.useRef(null),c=a.exports.useRef(),i=a.exports.useRef(null);function l(){s.current.value="",i.current.value="",c.current.resetSelectValue()}function r(h){if(!e){h.preventDefault();const m=s.current.value,y=c.current.getSelectValue(),v=i.current.value,N={title:m,category:y,text:v,id:E()};o.addNote(N),l(),n(!0)}}function u(){n(!1)}return d("div",{className:"create-note-container",children:[e&&t(C,{hideMessage:u,children:"Note added !"}),t("h1",{children:"Create a note "}),d("form",{onSubmit:r,children:[t(p,{ref:s,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30}),t(b,{labelMessage:"Choose a category",ref:c}),t(S,{name:"textNote",ref:i}),d("div",{className:"field",children:[d("button",{type:"submit",className:"btn-blue",children:[" ","Save"," "]}),d("button",{type:"button",className:"btn-blue red",onClick:l,children:[" ","Discard"," "]})]})]})]})}function F(e){const{title:n,category:o,text:s}=e.note;a.exports.useRef(null);const c=s.split(`
`).map((i,l)=>d(k.Fragment,{children:[i,t("br",{})]},l));return d(I,{closePanel:e.closeNote,plusClass:"note-max-extended",children:[(o!=null?o:o!=="")?t("label",{children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:c})]})}function L(e){const[n,o]=a.exports.useState(!1);function s(){o(!0)}function c(){o(!1)}return d(T,{children:[n&&t(F,{note:e,closeNote:c}),d("div",{className:"note-item",onClick:s,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category!==""&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function w(e){function n(o,s){return o.category>s.category?1:o.category<s.category?-1:o.title>s.title?1:o.title<s.title?-1:0}return e.sort(n)}function Y(e){const[n,o]=a.exports.useState(e.options[0]),[s,c]=a.exports.useState(!1),i=a.exports.useId();function l(){c(u=>!u)}function r(u){var m;const h=u.target.value;h!==n&&(o(h),(m=e.onSelection)==null||m.call(e,h)),c(!1)}return d("div",{className:"select-interactive",children:[t("div",{className:`select-interactive__ctn ${s?"select-interactive__ctn--open":""}`,onClick:l,title:n,role:"button",tabIndex:0,onBlur:()=>c(!1),children:n}),t("div",{className:`select-interactive__options ${s?"select-interactive__options--open":""}`,children:e.options.map((u,h)=>t("button",{value:u,onClick:r,title:u,children:u},`${i}-${h}`))})]})}function O(){const e=w(a.exports.useContext(x).getNotes()),n=a.exports.useContext(D).getCategories(),[o,s]=a.exports.useState("all"),c=e.filter(l=>o==="all"||l.category===o).map(l=>t(L,{id:l.id,title:l.title,text:l.text,category:l.category},l.id)),i=c.length;return d("div",{className:"view-notes",children:[d("h3",{children:["Select a category\xA0",t(Y,{options:["all",...n],onSelection:l=>{s(l)}})]}),t("h1",{children:i===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":i===1?"You have only 1 note!":`You have ${i} notes!`}),i>0&&t("div",{className:"view-notes__container",children:c})]})}function P(e){return d("div",{className:"note-item-edit",children:[t("h2",{title:e.title,children:e.title}),e.category!==M[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function $({note:e,closeEditMode:n}){const[o,s]=a.exports.useState(!1),c=a.exports.useContext(x),i=a.exports.useRef(null),l=a.exports.useRef(null),r=a.exports.useRef(null),u=a.exports.useRef(null);function h(N){N.preventDefault();const g={title:l.current.value,category:r.current.getSelectValue(),text:u.current.value,id:e.id};(g.title!==e.title||g.category!==e.category||g.text!==e.text)&&(c.modifyNote(g),s(!0))}function m(){s(!1)}function y(){l.current.value=e.title,u.current.value=e.text,r.current.setValue(e.category)}function v(){i.current.classList.add("anim-line-down-modify"),setTimeout(()=>n(),600)}return t("div",{className:"backdrop",onClick:v,children:d("div",{className:"note-modify",ref:i,onClick:N=>N.stopPropagation(),children:[o&&t(C,{hideMessage:m,durationSeconds:2.2,children:"Note changed !"}),t("h2",{children:"Edit note "}),d("form",{onSubmit:h,children:[t(p,{ref:l,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title}),t(b,{labelMessage:"Change the category",ref:r,valueDefault:e.category}),t(S,{name:"textNote",ref:u,value:e.text}),d("div",{className:"modify-buttons",children:[t("button",{children:"Save"}),t("button",{type:"button",onClick:y,className:"red",title:"Reset to the last saved content",children:"Discard changes"})]})]}),t("button",{className:"close-btn",onClick:v,children:"\xD7"})]})})}function j(e){const n=a.exports.useRef(null),o=a.exports.useContext(x);function s(){n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}function c(){o.deleteNoteById(e.id),n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}return t("div",{className:"backdrop",onClick:s,children:d("div",{className:"delete-form",ref:n,onClick:i=>i.stopPropagation(),children:[t("button",{className:"close-btn",onClick:s,children:"\xD7"}),t("h2",{children:"Do you really want to delete this note ?"}),d("div",{children:[t("button",{className:"del-btn",onClick:c,children:"Yes"}),t("button",{className:"del-btn btn-no",onClick:s,children:"No"})]})]})})}const B=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t($,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(j,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function A(){const[e,n]=a.exports.useReducer(B,void 0),o=w(a.exports.useContext(x).getNotes());function s(r){n({type:1,item:r,closeEditMode:i})}function c(r){n({type:2,item:r,closeEditMode:i})}function i(){n({type:0})}const l=o.map((r,u)=>t(P,{title:r.title,category:r.category,text:r.text,modifyItem:()=>{s(r)},deleteItem:()=>{c(r)}},u));return d("div",{className:"edit-note-container",children:[e,t("h2",{children:o.length===0?"You have no notes to edit .":o.length===1?"You have only 1 note .":"You have "+o.length.toString()+" notes that can be modified ."}),o.length>0&&t("div",{className:"notes-container",children:l})]})}const U=[{noteState:f.viewNotes,component:t(O,{})},{noteState:f.createNote,component:t(_,{})},{noteState:f.editNote,component:t(A,{})}];function W({currentStatus:e}){const n=U.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function H(){const[e,n]=a.exports.useState({navNotesState:f.viewNotes});function o(s){n({navNotesState:s})}return d("section",{className:"note-container",children:[t(V,{initialNavState:e.navNotesState,setNavNotesState:o}),t(W,{currentStatus:e.navNotesState})]})}export{H as default};
