import{r as s,j as t,a as u,N as y,b as I,C as b,R as _,F as D,c as F}from"./index.7aa0ffc2.js";import{T as O}from"./TextArea.d93e9e3a.js";import{I as T}from"./InputText.4e1ed91b.js";import{P as w}from"./PanelWithBackdrop.ac4fd46c.js";var v=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(v||{});const V=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function H(e){const[n,o]=s.exports.useState(()=>e.initialNavState),i=s.exports.useId();function r(a){const{currentTarget:h}=a,x=+h.name;n!==x&&(e.setNavNotesState(x),o(x))}const c=V.map((a,h)=>t("button",{className:n===a.btnValue?"note-nav__selected":"",name:a.btnValue.toString(),onClick:r,children:a.navTitle},`${i}-${h}`));return t("section",{className:"note-nav",children:c})}let L=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function M(e,n){var N;const[o,i]=s.exports.useState((N=e.defaultOption)!=null?N:e.options[0]),[r,c]=s.exports.useState(!1),a=s.exports.useId();s.exports.useImperativeHandle(n,()=>({resetSelectValue(){var d;i((d=e.defaultOption)!=null?d:e.options[0])}}));function h(){c(d=>!d)}function x(d){const l=d.target.value;l!==o&&(i(l),e.onSelection(l)),c(!1)}return u("div",{className:"select-interactive",children:[t("div",{className:`select-interactive__ctn ${r?"select-interactive__ctn--open":""}`,onClick:h,title:o.toString(),role:"button",tabIndex:0,onBlur:()=>c(!1),children:o}),t("div",{className:`select-interactive__options ${r?"select-interactive__options--open":""}`,children:e.options.map((d,l)=>t("button",{type:"button",value:d,onClick:x,title:d,className:d===o?"selected":"",children:d},`${a}-${l}`))})]})}const R=s.exports.forwardRef(M);function P(){const e=s.exports.useContext(y),n=s.exports.useContext(I),o=s.exports.useContext(b).getCategories(),i=s.exports.useRef(null),[r,c]=s.exports.useState("none"),a=s.exports.useRef(null),[h,x]=s.exports.useState(""),N=s.exports.useRef(null),[d,l]=s.exports.useState("");function f(){var m;x(""),a.current.value="",l(""),N.current.value="",c("none"),(m=i.current)==null||m.resetSelectValue()}function C(m){m.preventDefault();const S={title:h,category:r,text:d,id:L()};n.showNotification("Note added !"),e.addNote(S),f()}return u("div",{className:"create-note-container",children:[t("h1",{children:"Create a note"}),u("form",{onSubmit:C,children:[t(T,{ref:a,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30,onChangeHandler:x}),u("div",{className:"field",children:["Choose a category"," ",t(R,{options:o,onSelection:m=>{c(m)},ref:i})]}),t(O,{name:"textNote",ref:N,onChangeHandler:l}),u("div",{className:"field-group-btns",children:[t("button",{type:"submit",className:"btn-blue",disabled:h.length<3,children:"Save"}),t("button",{type:"button",className:"btn-blue red",onClick:f,disabled:h.length===0&&r==="none"&&d==="",children:"Discard"})]})]})]})}function $(e){const{title:n,category:o,text:i}=e.note,r=i.split(`
`).map((c,a)=>u(_.Fragment,{children:[c,t("br",{})]},a));return u(w,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:r})]})}function B(e){const[n,o]=s.exports.useState(!1);function i(){o(!0)}function r(){o(!1)}return u(D,{children:[n&&t($,{note:e,closeNote:r}),u("div",{className:"note-item",onClick:i,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category.length>0&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function Y(e,n){const o=e.category==="none"?"":e.category,i=n.category==="none"?"":n.category;return o>i?1:o<i?-1:e.title>n.title?1:e.title<n.title?-1:0}function E(e){return e.sort(Y)}function j(){const e=E(s.exports.useContext(y).getNotes()),n=s.exports.useContext(b).getCategories(),[o,i]=s.exports.useState("all"),r=e.filter(a=>o==="all"||a.category===o).map(a=>t(B,{id:a.id,title:a.title,text:a.text,category:a.category},a.id)),c=r.length;return u("div",{className:"view-notes",children:[u("h3",{children:[t("span",{children:"Select a category\xA0"}),t(R,{options:["all",...n],onSelection:a=>{i(a)}})]}),t("h1",{children:c===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":c===1?"You have only 1 note!":`You have ${c} notes!`}),c>0&&t("div",{className:"view-notes__container",children:r})]})}function A(e){var n,o;return u("div",{className:"note-item-edit",children:[e.numOfFirstLetersToHighlight?u("h2",{title:e.title,children:[t("span",{className:"text-highlighted",children:(n=e.title)==null?void 0:n.slice(0,e.numOfFirstLetersToHighlight)}),(o=e.title)==null?void 0:o.slice(e.numOfFirstLetersToHighlight)]}):t("h2",{title:e.title,children:e.title}),e.category!==F[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function W({note:e,closeEditMode:n}){const o=s.exports.useContext(I),i=s.exports.useContext(y),r=s.exports.useContext(b).getCategories(),c=s.exports.useRef(null),[a,h]=s.exports.useState(e.category),x=s.exports.useRef(null),[N,d]=s.exports.useState(e.title),l=s.exports.useRef(null),[f,C]=s.exports.useState(e.text),m=N!==e.title||a!==e.category||f!==e.text;function S(g){g.preventDefault();const p={title:x.current.value,category:a,text:l.current.value,id:e.id};(p.title!==e.title||p.category!==e.category||p.text!==e.text)&&(i.modifyNote(p),o.showNotification("Note changed !"))}function k(){var g;x.current.value=e.title,d(e.title),l.current.value=e.text,C(e.text),(g=c.current)==null||g.resetSelectValue(),h(e.category)}return u(w,{closePanel:n,plusClass:"panel-max-extended",children:[t("h2",{children:"Edit note "}),u("form",{onSubmit:S,children:[t(T,{ref:x,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title,onChangeHandler:d}),u("div",{className:"field",children:["Change the category",t(R,{options:r,defaultOption:e.category,onSelection:g=>{h(g)},ref:c})]}),t(O,{name:"textNote",ref:l,value:e.text,onChangeHandler:C}),u("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",disabled:!m,children:"Save"}),t("button",{type:"button",onClick:k,className:"btn-blue red",title:"Reset to the last saved content",disabled:!m,children:"Discard changes"})]})]})]})}function U(e){const n=s.exports.useContext(y),o=s.exports.useRef(null);function i(){var c;(c=o.current)==null||c.closeBackdrop()}function r(){n.deleteNoteById(e.id),i()}return u(w,{closePanel:e.closeDeleteForm,plusClass:"panel-mind-extended",ref:o,children:[t("h1",{children:"Do you really want to delete this note?"}),u("div",{children:[t("button",{className:"confirmation-btn",onClick:r,children:"Yes"}),t("button",{className:"confirmation-btn btn-no",onClick:i,children:"No"})]})]})}const q=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(W,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(U,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function K(){const[e,n]=s.exports.useReducer(q,void 0),o=E(s.exports.useContext(y).getNotes()),i=o.length,[r,c]=s.exports.useState(""),a=r.length;function h(l){n({type:1,item:l,closeEditMode:N})}function x(l){n({type:2,item:l,closeEditMode:N})}function N(){n({type:0})}const d=o.filter(l=>l.title.startsWith(r)).map((l,f)=>t(A,{title:l.title,numOfFirstLetersToHighlight:a,category:l.category,text:l.text,modifyItem:()=>{h(l)},deleteItem:()=>{x(l)}},f));return u("div",{className:"edit-note-container",children:[e,i===0&&t("h2",{children:`"You don't have any notes to edit!"`}),i>3&&t(T,{required:!1,text:"Search the note by name",onChangeHandler:l=>{c(l)}}),d.length>0&&t("div",{className:"notes-container",children:d}),d.length===0&&a>0&&t("h2",{children:"You don't have any note with this name!"})]})}const z=[{noteState:v.viewNotes,component:t(j,{})},{noteState:v.createNote,component:t(P,{})},{noteState:v.editNote,component:t(K,{})}];function G({currentStatus:e}){const n=z.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function ee(){const[e,n]=s.exports.useState({navNotesState:v.viewNotes});function o(i){n({navNotesState:i})}return u("section",{className:"note-container",children:[t(H,{initialNavState:e.navNotesState,setNavNotesState:o}),t(G,{currentStatus:e.navNotesState})]})}export{ee as default};
