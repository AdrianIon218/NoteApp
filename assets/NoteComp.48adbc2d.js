import{r as s,j as t,N as C,a as E,C as p,b as i,R as F,F as k,c as O}from"./index.c37fc3ea.js";import{T as I}from"./TextArea.53837d19.js";import{I as T}from"./InputText.3986404d.js";import{S as w,P as R}from"./PanelWithBackdrop.3cddd982.js";var v=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(v||{});const V=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function H(e){const[n,o]=s.exports.useState(()=>e.initialNavState),l=s.exports.useId();function r(a){const{currentTarget:u}=a,h=+u.name;n!==h&&(e.setNavNotesState(h),o(h))}const c=V.map((a,u)=>t("button",{className:n===a.btnValue?"note-nav__selected":"",name:a.btnValue.toString(),onClick:r,children:a.navTitle},`${l}-${u}`));return t("section",{className:"note-nav",children:c})}let M=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function P(){const e=s.exports.useContext(C),n=s.exports.useContext(E),o=s.exports.useContext(p).getCategories(),l=s.exports.useRef(null),[r,c]=s.exports.useState("none"),a=s.exports.useRef(null),[u,h]=s.exports.useState(""),m=s.exports.useRef(null),[g,N]=s.exports.useState("");function d(){var x;h(""),a.current.value="",N(""),m.current.value="",c("none"),(x=l.current)==null||x.resetSelectValue()}function f(x){x.preventDefault();const b={title:u,category:r,text:g,id:M()};n.showNotification("Note added !"),e.addNote(b),d()}return i("div",{className:"create-note-container",children:[t("h1",{children:"Create a note"}),i("form",{onSubmit:f,children:[t(T,{ref:a,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30,onChangeHandler:h}),i("div",{className:"field",children:["Choose a category"," ",t(w,{options:o,onSelection:x=>{c(x)},ref:l})]}),t(I,{name:"textNote",ref:m,onChangeHandler:N}),i("div",{className:"field-group-btns",children:[t("button",{type:"submit",className:"btn-blue",disabled:u.length<3,children:"Save"}),t("button",{type:"button",className:"btn-blue red",onClick:d,disabled:u.length===0&&r==="none"&&g==="",children:"Discard"})]})]})]})}function Y(e){const{title:n,category:o,text:l}=e.note,r=l.split(`
`).map((c,a)=>i(F.Fragment,{children:[c,t("br",{})]},a));return i(R,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:r})]})}function B(e){const[n,o]=s.exports.useState(!1);function l(){o(!0)}function r(){o(!1)}return i(k,{children:[n&&t(Y,{note:e,closeNote:r}),i("div",{className:"note-item",onClick:l,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category.length>0&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function _(e,n){const o=e.category==="none"?"":e.category,l=n.category==="none"?"":n.category;return o>l?1:o<l?-1:e.title>n.title?1:e.title<n.title?-1:0}function L(e){return e.sort(_)}function j(){const e=L(s.exports.useContext(C).getNotes()),n=s.exports.useContext(p).getCategories(),[o,l]=s.exports.useState("all"),r=e.filter(a=>o==="all"||a.category===o).map(a=>t(B,{id:a.id,title:a.title,text:a.text,category:a.category},a.id)),c=r.length;return i("div",{className:"view-notes",children:[e.length>0&&i("h3",{children:[t("span",{children:"Select a category\xA0"}),t(w,{options:["all",...n],onSelection:a=>{l(a)}})]}),t("h1",{children:c===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":c===1?"You have only 1 note!":`You have ${c} notes!`}),c>0&&t("div",{className:"view-notes__container",children:r})]})}function A(e){var n,o;return i("div",{className:"note-item-edit",children:[e.numOfFirstLetersToHighlight?i("h2",{title:e.title,children:[t("span",{className:"text-highlighted",children:(n=e.title)==null?void 0:n.slice(0,e.numOfFirstLetersToHighlight)}),(o=e.title)==null?void 0:o.slice(e.numOfFirstLetersToHighlight)]}):t("h2",{title:e.title,children:e.title}),e.category!==O[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function W({note:e,closeEditMode:n}){const o=s.exports.useContext(E),l=s.exports.useContext(C),r=s.exports.useContext(p).getCategories(),c=s.exports.useRef(null),[a,u]=s.exports.useState(e.category),h=s.exports.useRef(null),[m,g]=s.exports.useState(e.title),N=s.exports.useRef(null),[d,f]=s.exports.useState(e.text),x=m!==e.title||a!==e.category||d!==e.text;function b(y){y.preventDefault();const S={title:h.current.value,category:a,text:N.current.value,id:e.id};(S.title!==e.title||S.category!==e.category||S.text!==e.text)&&(l.modifyNote(S),o.showNotification("Note changed !"))}function D(){var y;h.current.value=e.title,g(e.title),N.current.value=e.text,f(e.text),(y=c.current)==null||y.resetSelectValue(),u(e.category)}return i(R,{closePanel:n,plusClass:"panel-max-extended",children:[t("h2",{children:"Edit note "}),i("form",{onSubmit:b,children:[t(T,{ref:h,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title,onChangeHandler:g}),i("div",{className:"field",children:["Change the category",t(w,{options:r,defaultOption:e.category,onSelection:y=>{u(y)},ref:c})]}),t(I,{name:"textNote",ref:N,value:e.text,onChangeHandler:f}),i("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",disabled:!x,children:"Save"}),t("button",{type:"button",onClick:D,className:"btn-blue red",title:"Reset to the last saved content",disabled:!x,children:"Discard changes"})]})]})]})}function $(e){const n=s.exports.useContext(C),o=s.exports.useRef(null);function l(){var c;(c=o.current)==null||c.closeBackdrop()}function r(){n.deleteNoteById(e.id),l()}return i(R,{closePanel:e.closeDeleteForm,plusClass:"panel-mind-extended",ref:o,children:[t("h1",{children:"Do you really want to delete this note?"}),i("div",{children:[t("button",{className:"confirmation-btn",onClick:r,children:"Yes"}),t("button",{className:"confirmation-btn btn-no",onClick:l,children:"No"})]})]})}const U=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(W,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t($,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function q(){const[e,n]=s.exports.useReducer(U,void 0),o=L(s.exports.useContext(C).getNotes()),l=o.length,[r,c]=s.exports.useState(""),a=r.length;function u(d){n({type:1,item:d,closeEditMode:m})}function h(d){n({type:2,item:d,closeEditMode:m})}function m(){n({type:0})}const g=r.toLowerCase(),N=o.filter(d=>d.title.toLowerCase().startsWith(g)).map((d,f)=>t(A,{title:d.title,numOfFirstLetersToHighlight:a,category:d.category,text:d.text,modifyItem:()=>{u(d)},deleteItem:()=>{h(d)}},f));return i("div",{className:"edit-note-container",children:[e,l===0&&t("h2",{children:"You don't have any notes to edit!"}),l>3&&t(T,{required:!1,text:"Search the note by name",onChangeHandler:d=>{c(d)}}),N.length>0&&t("div",{className:"notes-container",children:N}),N.length===0&&a>0&&t("h2",{children:"You don't have any note with this name!"})]})}const z=[{noteState:v.viewNotes,component:t(j,{})},{noteState:v.createNote,component:t(P,{})},{noteState:v.editNote,component:t(q,{})}];function G({currentStatus:e}){const n=z.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function Z(){const[e,n]=s.exports.useState({navNotesState:v.viewNotes});function o(l){n({navNotesState:l})}return i("section",{className:"note-container",children:[t(H,{initialNavState:e.navNotesState,setNavNotesState:o}),t(G,{currentStatus:e.navNotesState})]})}export{Z as default};
