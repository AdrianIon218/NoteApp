import{r as s,j as t,a as i,N as p,C as S,R,F as M,c as E}from"./index.f17b39f8.js";import{T as b}from"./TextArea.e3ad4a2d.js";import{T as w,I as T}from"./TemporalNotification.bcd7c905.js";import{P as I}from"./PanelWithBackdrop.362705f6.js";var v=(e=>(e[e.viewNotes=0]="viewNotes",e[e.createNote=1]="createNote",e[e.editNote=2]="editNote",e))(v||{});const D=[{btnValue:0,navTitle:"My Notes"},{btnValue:1,navTitle:"New Note"},{btnValue:2,navTitle:"Edit Note"}];function V(e){const[n,o]=s.exports.useState(()=>e.initialNavState),a=s.exports.useId();function r(l){const{currentTarget:c}=l,h=+c.name;n!==h&&(e.setNavNotesState(h),o(h))}const d=D.map((l,c)=>t("button",{className:n===l.btnValue?"note-nav__selected":"",name:l.btnValue.toString(),onClick:r,children:l.navTitle},`${a}-${c}`));return t("section",{className:"note-nav",children:d})}let _=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");function O(e,n){var m;const[o,a]=s.exports.useState((m=e.defaultOption)!=null?m:e.options[0]),[r,d]=s.exports.useState(!1),l=s.exports.useId();s.exports.useImperativeHandle(n,()=>({resetSelectValue(){var u;a((u=e.defaultOption)!=null?u:e.options[0])}}));function c(){d(u=>!u)}function h(u){const N=u.target.value;N!==o&&(a(N),e.onSelection(N)),d(!1)}return i("div",{className:"select-interactive",children:[t("div",{className:`select-interactive__ctn ${r?"select-interactive__ctn--open":""}`,onClick:c,title:o,role:"button",tabIndex:0,onBlur:()=>d(!1),children:o}),t("div",{className:`select-interactive__options ${r?"select-interactive__options--open":""}`,children:e.options.map((u,N)=>t("button",{type:"button",value:u,onClick:h,title:u,children:u},`${l}-${N}`))})]})}const C=s.exports.forwardRef(O);function F(){const[e,n]=s.exports.useState(!1),o=s.exports.useContext(p),a=s.exports.useContext(S).getCategories(),r=s.exports.useRef(null),[d,l]=s.exports.useState("none"),c=s.exports.useRef(null),h=s.exports.useRef(null);function m(){var f;r.current.value="",c.current.value="",l("none"),(f=h.current)==null||f.resetSelectValue()}function u(f){if(!e){f.preventDefault();const y=r.current.value,x=c.current.value,g={title:y,category:d,text:x,id:_()};o.addNote(g),m(),n(!0)}}function N(){n(!1)}return i("div",{className:"create-note-container",children:[e&&t(w,{hideMessage:N,children:"Note added !"}),t("h1",{children:"Create a note "}),i("form",{onSubmit:u,children:[t(T,{ref:r,text:"Title",customText:"Insert a title between 3 and 30 characters",minLength:3,maxLength:30}),i("div",{className:"field",children:["Choose a category"," ",t(C,{options:a,onSelection:f=>{l(f)},ref:h})]}),t(b,{name:"textNote",ref:c}),i("div",{className:"field-group-btns",children:[i("button",{type:"submit",className:"btn-blue",children:[" ","Save"," "]}),i("button",{type:"button",className:"btn-blue red",onClick:m,children:[" ","Discard"," "]})]})]})]})}function P(e){const{title:n,category:o,text:a}=e.note;s.exports.useRef(null);const r=a.split(`
`).map((d,l)=>i(R.Fragment,{children:[d,t("br",{})]},l));return i(I,{closePanel:e.closeNote,plusClass:"panel-max-extended",children:[(o!=null?o:o!=="")?t("label",{className:"category-label",children:o}):null,t("h2",{title:n,children:n}),t("div",{className:"note-text",children:r})]})}function Y(e){const[n,o]=s.exports.useState(!1);function a(){o(!0)}function r(){o(!1)}return i(M,{children:[n&&t(P,{note:e,closeNote:r}),i("div",{className:"note-item",onClick:a,children:[t("h2",{title:e.title,children:e.title}),e.category!=="none"&&e.category!==""&&t("label",{children:e.category}),t("div",{children:e.text.split(`
`)[0]})]})]})}function $(e,n){const o=e.category==="none"?"":e.category,a=n.category==="none"?"":n.category;return o>a?1:o<a?-1:e.title>n.title?1:e.title<n.title?-1:0}function k(e){return e.sort($)}function L(){const e=k(s.exports.useContext(p).getNotes()),n=s.exports.useContext(S).getCategories(),[o,a]=s.exports.useState("all"),r=e.filter(l=>o==="all"||l.category===o).map(l=>t(Y,{id:l.id,title:l.title,text:l.text,category:l.category},l.id)),d=r.length;return i("div",{className:"view-notes",children:[i("h3",{children:[t("span",{children:"Select a category\xA0"}),t(C,{options:["all",...n],onSelection:l=>{a(l)}})]}),t("h1",{children:d===0?o==="all"?"You don't have any notes!":"You don't have any notes of this category!":d===1?"You have only 1 note!":`You have ${d} notes!`}),d>0&&t("div",{className:"view-notes__container",children:r})]})}function B(e){return i("div",{className:"note-item-edit",children:[t("h2",{title:e.title,children:e.title}),e.category!==E[0]&&t("label",{children:e.category}),t("div",{className:"edit-btn",onClick:()=>e.modifyItem(),children:t("button",{children:"edit"})}),t("div",{className:"edit-btn",onClick:()=>e.deleteItem(),children:t("button",{className:"delete",children:"delete"})})]})}function j({note:e,closeEditMode:n}){const[o,a]=s.exports.useState(!1),r=s.exports.useContext(p),d=s.exports.useContext(S).getCategories(),[l,c]=s.exports.useState(e.category),h=s.exports.useRef(null),m=s.exports.useRef(null),u=s.exports.useRef(null);function N(x){x.preventDefault();const g={title:m.current.value,category:l,text:u.current.value,id:e.id};(g.title!==e.title||g.category!==e.category||g.text!==e.text)&&(r.modifyNote(g),a(!0))}function f(){a(!1)}function y(){var x;m.current.value=e.title,u.current.value=e.text,c(e.category),(x=h.current)==null||x.resetSelectValue()}return i(I,{closePanel:n,plusClass:"panel-max-extended",children:[o&&t(w,{hideMessage:f,durationSeconds:2.2,children:"Note changed !"}),t("h2",{children:"Edit note "}),i("form",{onSubmit:N,children:[t(T,{ref:m,text:"Title",customText:"The title must be between 3 and 30 characters !",minLength:3,maxLength:30,value:e.title}),i("div",{className:"field",children:["Change the category",t(C,{options:d,defaultOption:e.category,onSelection:x=>{c(x)},ref:h})]}),t(b,{name:"textNote",ref:u,value:e.text}),i("div",{className:"field-group-btns",children:[t("button",{className:"btn-blue",children:"Save"}),t("button",{type:"button",onClick:y,className:"btn-blue red",title:"Reset to the last saved content",children:"Discard changes"})]})]})]})}function A(e){const n=s.exports.useRef(null),o=s.exports.useContext(p);function a(){n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}function r(){o.deleteNoteById(e.id),n.current.classList.add("anim-line-down-del"),setTimeout(e.closeDeleteForm,350)}return t("div",{className:"backdrop",onClick:a,children:i("div",{className:"delete-form",ref:n,onClick:d=>d.stopPropagation(),children:[t("button",{className:"close-btn",onClick:a,children:"\xD7"}),t("h2",{children:"Do you really want to delete this note ?"}),i("div",{children:[t("button",{className:"del-btn",onClick:r,children:"Yes"}),t("button",{className:"del-btn btn-no",onClick:a,children:"No"})]})]})})}const U=(e,n)=>{switch(n.type){case 0:return;case 1:return n.item&&n.closeEditMode&&t(j,{note:n.item,closeEditMode:n.closeEditMode});case 2:return n.item&&n.closeEditMode&&t(A,{closeDeleteForm:n.closeEditMode,id:n.item.id})}};function W(){const[e,n]=s.exports.useReducer(U,void 0),o=k(s.exports.useContext(p).getNotes());function a(c){n({type:1,item:c,closeEditMode:d})}function r(c){n({type:2,item:c,closeEditMode:d})}function d(){n({type:0})}const l=o.map((c,h)=>t(B,{title:c.title,category:c.category,text:c.text,modifyItem:()=>{a(c)},deleteItem:()=>{r(c)}},h));return i("div",{className:"edit-note-container",children:[e,t("h2",{children:o.length===0?"You have no notes to edit .":o.length===1?"You have only 1 note .":"You have "+o.length.toString()+" notes that can be modified ."}),o.length>0&&t("div",{className:"notes-container",children:l})]})}const H=[{noteState:v.viewNotes,component:t(L,{})},{noteState:v.createNote,component:t(F,{})},{noteState:v.editNote,component:t(W,{})}];function K({currentStatus:e}){const n=H.filter(o=>o.noteState===e)[0];return t("section",{className:"note-box",children:n.component})}function Q(){const[e,n]=s.exports.useState({navNotesState:v.viewNotes});function o(a){n({navNotesState:a})}return i("section",{className:"note-container",children:[t(V,{initialNavState:e.navNotesState,setNavNotesState:o}),t(K,{currentStatus:e.navNotesState})]})}export{Q as default};
